---
title: "New TorNet Backdoor Abusing Windows Schedule Task to Deliver Malware"
date: 2025-01-29
---

A financially motivated threat actor has been linked to a sophisticated cyber campaign that has been targeting users in Poland and Germany since July 2024. 

The effort uses phishing emails to spread a range of malware payloads, including Agent Tesla, Snake Keylogger, and an undocumented backdoor called TorNet. 

This backdoor leverages Windows Scheduled Tasks for persistence and employs advanced evasion techniques to bypass detection.

Cisco Talos researchers report that the attack begins with phishing emails masquerading as financial institutions or logistics companies. These emails, written predominantly in Polish and German, contain malicious attachments compressed in .tgz format. 

<figure>

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXdpieLXmmrYq5LnZIVf9WdiN1owm0ex-vok667lvuw1Xk2Pk0iStk7us2nVZfeYXheiW4NTrAjgIF7OzdQmNnXBGA3Cq_14YXfYlfjjmalg8aMefs5IAJVqcIaD5_cCJj0W1wdmuw?key=AlrtDiUzTiLjcSzsxIQOqY7r)

<figcaption>

Sample phishing email in Polish

</figcaption>

</figure>

When victims extract and execute the attached files, a .NET loader downloads and decrypts the PureCrypter malware from compromised servers. PureCrypter then delivers the final payload, often the TorNet backdoor.

**Are you from SOC/DFIR Teams? – Analyse Malware Files & Links with ANY.RUN Sandox -> Try for Free**

## **The Attack Flow**

PureCrypter is a .NET-based malware loader designed for stealth. It uses AES encryption to obfuscate its payloads, which are either downloaded from hardcoded URLs or embedded within the loader itself. 

The malware decrypts these payloads in memory to avoid detection by antivirus solutions.

**Anti-analysis techniques:** It checks for debugging tools, sandbox environments (e.g., sbieDLL.dll), virtual machines (e.g., VMware), and anti-malware processes (amsi.dll).

**Network disconnection:** Before dropping its payload, PureCrypter releases the victim’s DHCP IP address, disconnecting from the network to evade cloud-based anti-malware solutions. It reconnects after executing the payload.

**Windows Scheduled Tasks for Persistence:** The malware creates tasks that execute every two to four minutes, even when running on low battery power.

<figure>

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXfD4X2lnM8w2AXuZw948aG31GELnoiu5oEZyglAOyhW350Iqu7eyja6VXMnFs3Hv7aNDSi7mp5fskj7MvVQ04UyjA0tCnOH0PD0HNFrnmnx9x6lvf1ktZlqo-PDeYVrLT-oyrOuVw?key=AlrtDiUzTiLjcSzsxIQOqY7r)

<figcaption>

The Attack flow

</figcaption>

</figure>

### **TorNet Backdoor Functionality**

The TorNet backdoor is a .NET-based malware obfuscated with Eziriz’s .NET Reactor. It connects infected machines to the TOR network for stealthy command-and-control (C2) communications.

**C2 Communication:** It decodes base64-encoded strings to retrieve C2 domains and port numbers. After resolving the domain’s IP address, it establishes a TCP socket connection.

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXd_K-FmYzoAqpXyB1J-JPJZqKRiodHt1nJZ49EwNGlxQtkmsmD7we7wd7N0wgeY2fsc3PeuMTgxURnUYn24KigdmInt9-tlO4w2AaJdmGOSoExL2uQPqGDWZxmvmxDieFIS7ClMwg?key=AlrtDiUzTiLjcSzsxIQOqY7r)

TorNet backdoor sample connecting to the C2 using the domain and port number

**Dynamic Payload Execution:** TorNet can download encrypted .NET assemblies from the C2 server, decrypt them using Triple DES encryption, and execute them reflectively in memory.

**TOR Integration:** The backdoor downloads the TOR Expert Bundle and runs tor.exe as a background process. All traffic is routed through TOR’s SocksPort (127.0.0.1:9050), anonymizing communications and evading network monitoring tools.

The attackers exploit Windows Task Scheduler to maintain persistence:

- Tasks are created using schtasks.exe, configured to run at regular intervals without execution time limits.

- Even on low battery power, tasks continue running uninterrupted, ensuring persistent infection.

- A Visual Basic script is dropped into the startup folder to load the backdoor upon system boot.

The threat actor employs several methods to evade detection:

- **Network Isolation:** Disconnecting from the network during payload execution prevents real-time monitoring by cloud-based security tools.

- **Registry Manipulation:** Decrypting task names and paths ensures that malicious tasks blend into legitimate system operations.

- **Memory-only Execution:** Reflective loading of payloads avoids writing files to disk, reducing forensic artifacts.

## **Recommendations**

The use of Windows Scheduled Tasks combined with TOR connectivity highlights an evolving trend in malware persistence and evasion tactics. Organizations are advised to:

- Monitor scheduled tasks for irregularities using centralized logging tools like Microsoft-Windows-TaskScheduler/Operational logs.

- Inspect registry keys under HKEY\_LOCAL\_MACHINESOFTWAREMicrosoftWindows NTCurrentVersionScheduleTaskCache for hidden tasks.

- Implement robust email filtering solutions to detect phishing attempts.

- Regularly update endpoint protection systems to identify obfuscated loaders like PureCrypter.

As cybercriminals continue innovating their techniques, proactive monitoring and layered defenses remain critical in mitigating such threats.

****Integrating Application Security into Your CI/CD Workflows Using Jenkins & Jira -> Free Webinar****

The post New TorNet Backdoor Abusing Windows Schedule Task to Deliver Malware appeared first on Cyber Security News.

Go to Source
