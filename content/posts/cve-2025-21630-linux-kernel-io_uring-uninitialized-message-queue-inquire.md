---
title: "CVE-2025-21630 - Linux Kernel: io_uring: Uninitialized Message Queue Inquire"
date: 2025-01-15
categories: 
  - "cve"
  - "cybersecurity"
  - "cybersecurity-awareness"
  - "security"
  - "threat-intelligence"
tags: 
  - "cve"
  - "cybersecurity"
  - "security"
---

**CVE ID :** CVE-2025-21630  
**Published :** Jan. 15, 2025, 1:15 p.m. | 1 hour, 2 minutes ago  
**Description :** In the Linux kernel, the following vulnerability has been resolved:

io\_uring/net: always initialize kmsg->msg.msg\_inq upfront

syzbot reports that ->msg\_inq may get used uinitialized from the following path:

BUG: KMSAN: uninit-value in io\_recv\_buf\_select io\_uring/net.c:1094 \[inline\] BUG: KMSAN: uninit-value in io\_recv+0x930/0x1f90 io\_uring/net.c:1158 io\_recv\_buf\_select io\_uring/net.c:1094 \[inline\] io\_recv+0x930/0x1f90 io\_uring/net.c:1158 io\_issue\_sqe+0x420/0x2130 io\_uring/io\_uring.c:1740 io\_queue\_sqe io\_uring/io\_uring.c:1950 \[inline\] io\_req\_task\_submit+0xfa/0x1d0 io\_uring/io\_uring.c:1374 io\_handle\_tw\_list+0x55f/0x5c0 io\_uring/io\_uring.c:1057 tctx\_task\_work\_run+0x109/0x3e0 io\_uring/io\_uring.c:1121 tctx\_task\_work+0x6d/0xc0 io\_uring/io\_uring.c:1139 task\_work\_run+0x268/0x310 kernel/task\_work.c:239 io\_run\_task\_work+0x43a/0x4a0 io\_uring/io\_uring.h:343 io\_cqring\_wait io\_uring/io\_uring.c:2527 \[inline\] \_\_do\_sys\_io\_uring\_enter io\_uring/io\_uring.c:3439 \[inline\] \_\_se\_sys\_io\_uring\_enter+0x204f/0x4ce0 io\_uring/io\_uring.c:3330 \_\_x64\_sys\_io\_uring\_enter+0x11f/0x1a0 io\_uring/io\_uring.c:3330 x64\_sys\_call+0xce5/0x3c30 arch/x86/include/generated/asm/syscalls\_64.h:427 do\_syscall\_x64 arch/x86/entry/common.c:52 \[inline\] do\_syscall\_64+0xcd/0x1e0 arch/x86/entry/common.c:83 entry\_SYSCALL\_64\_after\_hwframe+0x77/0x7f

and it is correct, as it's never initialized upfront. Hence the first submission can end up using it uninitialized, if the recv wasn't successful and the networking stack didn't honor ->msg\_get\_inq being set and filling in the output value of ->msg\_inq as requested.

Set it to 0 upfront when it's allocated, just to silence this KMSAN warning. There's no side effect of using it uninitialized, it'll just potentially cause the next receive to use a recv value hint that's not accurate.  
**Severity:** 0.0 | NA  
Visit the link for more details, such as CVSS details, affected products, timeline, and more...

Go to Source
