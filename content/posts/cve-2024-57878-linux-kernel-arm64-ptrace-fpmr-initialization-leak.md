---
title: "CVE-2024-57878 - Linux Kernel Arm64 Ptrace FPMR Initialization Leak"
date: 2025-01-12
categories: 
  - "cve"
  - "cybersecurity"
  - "cybersecurity-awareness"
  - "security"
  - "threat-intelligence"
tags: 
  - "cve"
  - "cybersecurity"
  - "security"
---

**CVE ID :** CVE-2024-57878  
**Published :** Jan. 11, 2025, 3:15 p.m. | 1Â day ago  
**Description :** In the Linux kernel, the following vulnerability has been resolved:

arm64: ptrace: fix partial SETREGSET for NT\_ARM\_FPMR

Currently fpmr\_set() doesn't initialize the temporary 'fpmr' variable, and a SETREGSET call with a length of zero will leave this uninitialized. Consequently an arbitrary value will be written back to target->thread.uw.fpmr, potentially leaking up to 64 bits of memory from the kernel stack. The read is limited to a specific slot on the stack, and the issue does not provide a write mechanism.

Fix this by initializing the temporary value before copying the regset from userspace, as for other regsets (e.g. NT\_PRSTATUS, NT\_PRFPREG, NT\_ARM\_SYSTEM\_CALL). In the case of a zero-length write, the existing contents of FPMR will be retained.

Before this patch:

| # ./fpmr-test | Attempting to write NT\_ARM\_FPMR::fpmr = 0x900d900d900d900d | SETREGSET(nt=0x40e, len=8) wrote 8 bytes | | Attempting to read NT\_ARM\_FPMR::fpmr | GETREGSET(nt=0x40e, len=8) read 8 bytes | Read NT\_ARM\_FPMR::fpmr = 0x900d900d900d900d | | Attempting to write NT\_ARM\_FPMR (zero length) | SETREGSET(nt=0x40e, len=0) wrote 0 bytes | | Attempting to read NT\_ARM\_FPMR::fpmr | GETREGSET(nt=0x40e, len=8) read 8 bytes | Read NT\_ARM\_FPMR::fpmr = 0xffff800083963d50

After this patch:

| # ./fpmr-test | Attempting to write NT\_ARM\_FPMR::fpmr = 0x900d900d900d900d | SETREGSET(nt=0x40e, len=8) wrote 8 bytes | | Attempting to read NT\_ARM\_FPMR::fpmr | GETREGSET(nt=0x40e, len=8) read 8 bytes | Read NT\_ARM\_FPMR::fpmr = 0x900d900d900d900d | | Attempting to write NT\_ARM\_FPMR (zero length) | SETREGSET(nt=0x40e, len=0) wrote 0 bytes | | Attempting to read NT\_ARM\_FPMR::fpmr | GETREGSET(nt=0x40e, len=8) read 8 bytes | Read NT\_ARM\_FPMR::fpmr = 0x900d900d900d900d  
**Severity:** 0.0 | NA  
Visit the link for more details, such as CVSS details, affected products, timeline, and more...

Go to Source
