---
title: "CVE-2024-57894 - Android Bluetooth Linux Kernel HCI Core Invalid Context Vulnerability"
date: 2025-01-15
categories: 
  - "cve"
  - "cybersecurity"
  - "cybersecurity-awareness"
  - "security"
  - "threat-intelligence"
tags: 
  - "cve"
  - "cybersecurity"
  - "security"
---

**CVE ID :** CVE-2024-57894  
**Published :** Jan. 15, 2025, 1:15 p.m. | 1 hour, 2 minutes ago  
**Description :** In the Linux kernel, the following vulnerability has been resolved:

Bluetooth: hci\_core: Fix sleeping function called from invalid context

This reworks hci\_cb\_list to not use mutex hci\_cb\_list\_lock to avoid bugs like the bellow:

BUG: sleeping function called from invalid context at kernel/locking/mutex.c:585 in\_atomic(): 0, irqs\_disabled(): 0, non\_block: 0, pid: 5070, name: kworker/u9:2 preempt\_count: 0, expected: 0 RCU nest depth: 1, expected: 0 4 locks held by kworker/u9:2/5070: #0: ffff888015be3948 ((wq\_completion)hci0#2){+.+.}-{0:0}, at: process\_one\_work kernel/workqueue.c:3229 \[inline\] #0: ffff888015be3948 ((wq\_completion)hci0#2){+.+.}-{0:0}, at: process\_scheduled\_works+0x8e0/0x1770 kernel/workqueue.c:3335 #1: ffffc90003b6fd00 ((work\_completion)(&hdev->rx\_work)){+.+.}-{0:0}, at: process\_one\_work kernel/workqueue.c:3230 \[inline\] #1: ffffc90003b6fd00 ((work\_completion)(&hdev->rx\_work)){+.+.}-{0:0}, at: process\_scheduled\_works+0x91b/0x1770 kernel/workqueue.c:3335 #2: ffff8880665d0078 (&hdev->lock){+.+.}-{3:3}, at: hci\_le\_create\_big\_complete\_evt+0xcf/0xae0 net/bluetooth/hci\_event.c:6914 #3: ffffffff8e132020 (rcu\_read\_lock){....}-{1:2}, at: rcu\_lock\_acquire include/linux/rcupdate.h:298 \[inline\] #3: ffffffff8e132020 (rcu\_read\_lock){....}-{1:2}, at: rcu\_read\_lock include/linux/rcupdate.h:750 \[inline\] #3: ffffffff8e132020 (rcu\_read\_lock){....}-{1:2}, at: hci\_le\_create\_big\_complete\_evt+0xdb/0xae0 net/bluetooth/hci\_event.c:6915 CPU: 0 PID: 5070 Comm: kworker/u9:2 Not tainted 6.8.0-syzkaller-08073-g480e035fc4c7 #0 Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 03/27/2024 Workqueue: hci0 hci\_rx\_work Call Trace: \_\_dump\_stack lib/dump\_stack.c:88 \[inline\] dump\_stack\_lvl+0x241/0x360 lib/dump\_stack.c:114 \_\_might\_resched+0x5d4/0x780 kernel/sched/core.c:10187 \_\_mutex\_lock\_common kernel/locking/mutex.c:585 \[inline\] \_\_mutex\_lock+0xc1/0xd70 kernel/locking/mutex.c:752 hci\_connect\_cfm include/net/bluetooth/hci\_core.h:2004 \[inline\] hci\_le\_create\_big\_complete\_evt+0x3d9/0xae0 net/bluetooth/hci\_event.c:6939 hci\_event\_func net/bluetooth/hci\_event.c:7514 \[inline\] hci\_event\_packet+0xa53/0x1540 net/bluetooth/hci\_event.c:7569 hci\_rx\_work+0x3e8/0xca0 net/bluetooth/hci\_core.c:4171 process\_one\_work kernel/workqueue.c:3254 \[inline\] process\_scheduled\_works+0xa00/0x1770 kernel/workqueue.c:3335 worker\_thread+0x86d/0xd70 kernel/workqueue.c:3416 kthread+0x2f0/0x390 kernel/kthread.c:388 ret\_from\_fork+0x4b/0x80 arch/x86/kernel/process.c:147 ret\_from\_fork\_asm+0x1a/0x30 arch/x86/entry/entry\_64.S:243  
**Severity:** 0.0 | NA  
Visit the link for more details, such as CVSS details, affected products, timeline, and more...

Go to Source
