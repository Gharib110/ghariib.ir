---
title: "<div>CVE-2024-57900 - \"Linux ILA Net Hooks Registration Race Vulnerability\"</div>"
date: 2025-01-15
categories: 
  - "cve"
  - "cybersecurity"
  - "cybersecurity-awareness"
  - "security"
  - "threat-intelligence"
tags: 
  - "cve"
  - "cybersecurity"
  - "security"
---

**CVE ID :** CVE-2024-57900  
**Published :** Jan. 15, 2025, 1:15 p.m. | 1 hour, 2 minutes ago  
**Description :** In the Linux kernel, the following vulnerability has been resolved:

ila: serialize calls to nf\_register\_net\_hooks()

syzbot found a race in ila\_add\_mapping() \[1\]

commit 031ae72825ce ("ila: call nf\_unregister\_net\_hooks() sooner") attempted to fix a similar issue.

Looking at the syzbot repro, we have concurrent ILA\_CMD\_ADD commands.

Add a mutex to make sure at most one thread is calling nf\_register\_net\_hooks().

\[1\] BUG: KASAN: slab-use-after-free in rht\_key\_hashfn include/linux/rhashtable.h:159 \[inline\] BUG: KASAN: slab-use-after-free in \_\_rhashtable\_lookup.constprop.0+0x426/0x550 include/linux/rhashtable.h:604 Read of size 4 at addr ffff888028f40008 by task dhcpcd/5501

CPU: 1 UID: 0 PID: 5501 Comm: dhcpcd Not tainted 6.13.0-rc4-syzkaller-00054-gd6ef8b40d075 #0 Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024 Call Trace: \_\_dump\_stack lib/dump\_stack.c:94 \[inline\] dump\_stack\_lvl+0x116/0x1f0 lib/dump\_stack.c:120 print\_address\_description mm/kasan/report.c:378 \[inline\] print\_report+0xc3/0x620 mm/kasan/report.c:489 kasan\_report+0xd9/0x110 mm/kasan/report.c:602 rht\_key\_hashfn include/linux/rhashtable.h:159 \[inline\] \_\_rhashtable\_lookup.constprop.0+0x426/0x550 include/linux/rhashtable.h:604 rhashtable\_lookup include/linux/rhashtable.h:646 \[inline\] rhashtable\_lookup\_fast include/linux/rhashtable.h:672 \[inline\] ila\_lookup\_wildcards net/ipv6/ila/ila\_xlat.c:127 \[inline\] ila\_xlat\_addr net/ipv6/ila/ila\_xlat.c:652 \[inline\] ila\_nf\_input+0x1ee/0x620 net/ipv6/ila/ila\_xlat.c:185 nf\_hook\_entry\_hookfn include/linux/netfilter.h:154 \[inline\] nf\_hook\_slow+0xbb/0x200 net/netfilter/core.c:626 nf\_hook.constprop.0+0x42e/0x750 include/linux/netfilter.h:269 NF\_HOOK include/linux/netfilter.h:312 \[inline\] ipv6\_rcv+0xa4/0x680 net/ipv6/ip6\_input.c:309 \_\_netif\_receive\_skb\_one\_core+0x12e/0x1e0 net/core/dev.c:5672 \_\_netif\_receive\_skb+0x1d/0x160 net/core/dev.c:5785 process\_backlog+0x443/0x15f0 net/core/dev.c:6117 \_\_napi\_poll.constprop.0+0xb7/0x550 net/core/dev.c:6883 napi\_poll net/core/dev.c:6952 \[inline\] net\_rx\_action+0xa94/0x1010 net/core/dev.c:7074 handle\_softirqs+0x213/0x8f0 kernel/softirq.c:561 \_\_do\_softirq kernel/softirq.c:595 \[inline\] invoke\_softirq kernel/softirq.c:435 \[inline\] \_\_irq\_exit\_rcu+0x109/0x170 kernel/softirq.c:662 irq\_exit\_rcu+0x9/0x30 kernel/softirq.c:678 instr\_sysvec\_apic\_timer\_interrupt arch/x86/kernel/apic/apic.c:1049 \[inline\] sysvec\_apic\_timer\_interrupt+0xa4/0xc0 arch/x86/kernel/apic/apic.c:1049  
**Severity:** 0.0 | NA  
Visit the link for more details, such as CVSS details, affected products, timeline, and more...

Go to Source
