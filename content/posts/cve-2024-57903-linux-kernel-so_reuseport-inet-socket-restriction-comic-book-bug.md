---
title: "CVE-2024-57903 - Linux kernel SO_REUSEPORT Inet Socket Restriction Comic Book Bug"
date: 2025-01-15
categories: 
  - "cve"
  - "cybersecurity"
  - "cybersecurity-awareness"
  - "security"
  - "threat-intelligence"
tags: 
  - "cve"
  - "cybersecurity"
  - "security"
---

**CVE ID :** CVE-2024-57903  
**Published :** Jan. 15, 2025, 1:15 p.m. | 1 hour, 2 minutes ago  
**Description :** In the Linux kernel, the following vulnerability has been resolved:

net: restrict SO\_REUSEPORT to inet sockets

After blamed commit, crypto sockets could accidentally be destroyed from RCU call back, as spotted by zyzbot \[1\].

Trying to acquire a mutex in RCU callback is not allowed.

Restrict SO\_REUSEPORT socket option to inet sockets.

v1 of this patch supported TCP, UDP and SCTP sockets, but fcnal-test.sh test needed RAW and ICMP support.

\[1\] BUG: sleeping function called from invalid context at kernel/locking/mutex.c:562 in\_atomic(): 1, irqs\_disabled(): 0, non\_block: 0, pid: 24, name: ksoftirqd/1 preempt\_count: 100, expected: 0 RCU nest depth: 0, expected: 0 1 lock held by ksoftirqd/1/24: #0: ffffffff8e937ba0 (rcu\_callback){....}-{0:0}, at: rcu\_lock\_acquire include/linux/rcupdate.h:337 \[inline\] #0: ffffffff8e937ba0 (rcu\_callback){....}-{0:0}, at: rcu\_do\_batch kernel/rcu/tree.c:2561 \[inline\] #0: ffffffff8e937ba0 (rcu\_callback){....}-{0:0}, at: rcu\_core+0xa37/0x17a0 kernel/rcu/tree.c:2823 Preemption disabled at: \[\] softirq\_handle\_begin kernel/softirq.c:402 \[inline\] \[\] handle\_softirqs+0x128/0x9b0 kernel/softirq.c:537 CPU: 1 UID: 0 PID: 24 Comm: ksoftirqd/1 Not tainted 6.13.0-rc3-syzkaller-00174-ga024e377efed #0 Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024 Call Trace: \_\_dump\_stack lib/dump\_stack.c:94 \[inline\] dump\_stack\_lvl+0x241/0x360 lib/dump\_stack.c:120 \_\_might\_resched+0x5d4/0x780 kernel/sched/core.c:8758 \_\_mutex\_lock\_common kernel/locking/mutex.c:562 \[inline\] \_\_mutex\_lock+0x131/0xee0 kernel/locking/mutex.c:735 crypto\_put\_default\_null\_skcipher+0x18/0x70 crypto/crypto\_null.c:179 aead\_release+0x3d/0x50 crypto/algif\_aead.c:489 alg\_do\_release crypto/af\_alg.c:118 \[inline\] alg\_sock\_destruct+0x86/0xc0 crypto/af\_alg.c:502 \_\_sk\_destruct+0x58/0x5f0 net/core/sock.c:2260 rcu\_do\_batch kernel/rcu/tree.c:2567 \[inline\] rcu\_core+0xaaa/0x17a0 kernel/rcu/tree.c:2823 handle\_softirqs+0x2d4/0x9b0 kernel/softirq.c:561 run\_ksoftirqd+0xca/0x130 kernel/softirq.c:950 smpboot\_thread\_fn+0x544/0xa30 kernel/smpboot.c:164 kthread+0x2f0/0x390 kernel/kthread.c:389 ret\_from\_fork+0x4b/0x80 arch/x86/kernel/process.c:147 ret\_from\_fork\_asm+0x1a/0x30 arch/x86/entry/entry\_64.S:244  
**Severity:** 0.0 | NA  
Visit the link for more details, such as CVSS details, affected products, timeline, and more...

Go to Source
