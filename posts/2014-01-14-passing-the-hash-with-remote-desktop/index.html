<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>Passing the Hash with Remote Desktop</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>Passing the Hash with Remote Desktop</h1>
			<b><time>14.01.2014 00:00</time></b>
		       

			<div>
				<h1 id="passing-the-hash-with-remote-desktop">Passing the Hash with Remote Desktop</h1>
<p><a href="https://www.kali.org/blog/passing-hash-remote-desktop/images/kali-passing-the-hash.jpg">https://www.kali.org/blog/passing-hash-remote-desktop/images/kali-passing-the-hash.jpg</a></p>
<p>Kali Linux contains a large number of very useful tools that are beneficial to information security professionals. One set of such tools belongs to the Pass-the-Hash toolkit, which includes favorites such as pth-winexe among others, already packaged in Kali Linux. An example of easy command line access using pth-winexe is</p>
<p>Kali Linux contains a large number of very useful tools that are beneficial to information security professionals. One set of such tools belongs to the <strong><a href="https://www.kali.org/blog/pass-the-hash-toolkit-winexe-updates/">Pass-the-Hash</a></strong> toolkit, which includes favorites such as <strong>pth-winexe</strong> among others, already packaged in Kali Linux. An example of easy command line access using pth-winexe is shown below.</p>
<p><a href="https://www.kali.org/blog/passing-hash-remote-desktop/images/Screen-Shot-2014-01-14-at-9.53.44-AM.png">
<figure>
  <img src="https://www.kali.org/blog/passing-hash-remote-desktop/images/Screen-Shot-2014-01-14-at-9.53.44-AM.png" alt="" />
</figure>


</a></p>
<p>We constantly strive to include new, useful tools to our repositories. Sometimes we feel that some of these tools do not get the attention they deserve and go under-reported. One such recent addition is the version of FreeRDP, which allows a penetration tester to use a password hash instead of a plain text password for authentication to the remote desktop service in Windows 2012 R2 and Windows 8.1.</p>
<p>What’s the big deal, you say? Traditional “Pass-the-Hash” attacks can be very powerful, but they are limited to command line access. Although in most cases that is enough, sometimes GUI access is just a better way to accomplish things.</p>
<p>A few months ago, Mark Lowe from the Portcullis Labs published a <a href="https://labs.portcullis.co.uk/blog/new-restricted-admin-feature-of-rdp-8-1-allows-pass-the-hash/">blog post</a> on research he conducted against Windows 2012 R2 and Windows 8.1 RDP security improvements. It turns out that Microsoft, in their quest to mitigate “Pass-the-Hash” attacks, introduced something called “Restricted Admin” mode. You can read more about it <a href="https://docs.microsoft.com/en-us/archive/blogs/kfalde/restricted-admin-mode-for-rdp-in-windows-8-1-2012-r2">here</a>.</p>
<p>Inadvertently however, this new security feature actually enabled the use of a password hash for RDP authentication purposes, thereby giving many pentesters once again a reason to smile. To add to the validity of the research by Mark, the FreeRDP project has added native support for Pass-the-Hash authentication to the FreeRDP package, which is now in Kali repos. To enjoy this new feature, simply install freerdp-x11:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>apt-get update
</span></span><span style="display:flex;"><span>apt-get install freerdp-x11
</span></span></code></pre></div><p>The new xfreerdp executable supports the “/pth” flag as shown below using our “offsec” domain user and the “password” hash.</p>
<p><a href="https://www.kali.org/blog/passing-hash-remote-desktop/images/pth-rdp.png">
<figure>
  <img src="https://www.kali.org/blog/passing-hash-remote-desktop/images/pth-rdp.png" alt="" />
</figure>


</a></p>
<p>And that’s it! RDP sessions using harvested password hashes. Again, keep in mind that this only works on Windows 2012 R2 and Windows 8.1. To the best of our knowledge, the “Restricted Admin” feature has not been backported yet and considering this, it may never be.</p>
<h4 id="source"><a href="https://www.kali.org/blog/passing-hash-remote-desktop/">Source</a></h4>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2025-03-21-evolving-together-the-next-chapter-in-o/">Evolving Together The Next Chapter in Our Partner Journey</a></li>
				
				<li><a href="/posts/2025-03-21-this-week-in-security-the-github-supply/">This Week in Security The Github Supply Chain Attack Ransomware Decryption and Paragon</a></li>
				
				<li><a href="/posts/2025-03-21-modernize-your-industrial-infrastructur/">Modernize Your Industrial Infrastructure for Cybersecurity and AI Readiness with Cisco Validated Designs</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2025-2590---code-projects-human-res/">CVE-2025-2590 - Code-projects Human Resource Management System Cross-Site Scripting Vulnerability</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2025-2589---code-projects-human-res/">CVE-2025-2589 - Code-projects Human Resource Management System Unauthorized Access Vulnerability</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
