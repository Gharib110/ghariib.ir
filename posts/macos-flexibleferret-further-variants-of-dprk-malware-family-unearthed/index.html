<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>macOS FlexibleFerret | Further Variants of DPRK Malware Family Unearthed</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>macOS FlexibleFerret | Further Variants of DPRK Malware Family Unearthed</h1>
			<b><time>06.02.2025 00:00</time></b>
		       

			<div>
				<p>DPRK &lsquo;Contagious Interview&rsquo; campaign continues to target Mac users with new variants of FERRET malware and Github devs with repo spam.</p>
<p>Last week Apple pushed a signature update to its on-device malware tool XProtect to block several variants of what it called the macOS Ferret family: FROSTYFERRET_UI, FRIENDLYFERRET_SECD, and MULTI_FROSTYFERRET_CMDCODES. This DPRK-attributed malware family was first described by researchers in December and further in early January and identified as part of the North Korean Contagious Interview campaign, in which threat actors lure targets to install malware through the job interview process.</p>
<p>In this post, we briefly recap previous research for context, including Apple’s contribution through its malware signatures, before describing newly discovered samples that we have labelled ‘FlexibleFerret’ and which remain undetected by XProtect at the time of writing.</p>
<p>We provide a high level overview of the malware along with a list of indicators for threat hunters and defenders. SentinelOne customers are protected from all known variants of the Ferret family.</p>
<p>
<figure>
  <img src="https://www.sentinelone.com/wp-content/uploads/2025/02/FlexibleFerret_5.jpg" alt="" />
</figure>


</p>
<h2 id="a-ferret-family-background">A FERRET Family Background</h2>
<p>As noted above, previous researchers have described several malware components associated with the Contagious Interview campaign. Targets are typically asked to communicate with an interviewer through a link that throws an error message and a request to install or update some required piece of software such as VCam or CameraAccess for virtual meetings.</p>
<p>In previous reports, the observed malware ran a malicious shell script and installed a persistence agent and executable masquerading as a Google Chrome update. An excellent post published on January 5th digs into the details and source code of the shell loader, <code>ffmpeg.sh</code>, and the Go backdoor and stealer called, appropriately enough, <code>ChromeUpdate</code>.</p>
<p>Apple’s signature update last week targets some of the components of this malware campaign, including a backdoor that masquerades as an operating system file with the name <code>com.apple.secd</code> (<em>aka</em> FRIENDLYFERRET) along with the <code>ChromeUpdate</code> and <code>CameraAccess</code> persistence modules (<em>aka</em> FROSTYFERRET_UI).</p>
<p>Perhaps unsurprisingly, indicators present in the FERRET family of malware overlap with indicators seen in other DPRK campaigns, including the Hidden Risk campaign described recently by SentinelLABS.</p>
<!-- raw HTML omitted -->
<p>
<figure>
  <img src="https://www.sentinelone.com/wp-content/uploads/2025/02/FlexibleFerret_2.jpg" alt="Some common DPRK malware artifacts also seen in the Stage 2 ‘growth’ malware from Hidden Risk" />
</figure>


</p>
<!-- raw HTML omitted -->
<p>Some common DPRK malware artifacts also seen in the Stage 2 ‘growth’ malware from Hidden Risk</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Another commonality between FERRET and other recent DPRK campaigns is the use of Dropbox for exfiltration and the use of <code>api.ipify.org</code> to resolve the host’s public IP.</p>
<pre tabindex="0"><code>21  22   3.__TEXT.__cstring        ascii   https://api.ipify.org
39  40   3.__TEXT.__cstring        ascii   https://api.dropboxapi.com/oauth2/token
45  46   3.__TEXT.__cstring        ascii   https://content.dropboxapi.com/2/files/upload
</code></pre><h2 id="flexibleferret--an-expanded-malware-family-set">FlexibleFerret | An Expanded Malware Family Set</h2>
<p>Prior to Apple pushing XProtect version 5286, SentinelLABS had been tracking the malware identified by previous researchers and analysing a variant of the <code>ChromeUpdate</code> samples with the identifier <code>Mac-Installer.InstallerAlert</code>. Unlike the previous samples, this malware was signed with a valid Apple Developer signature (<code>VFYPGAKSLY</code>) and Team ID (<code>58CD8AD5Z4</code>). Pivoting off this led us to another previously unseen infection vector and set of related samples.</p>
<p>The dropper is an Apple Installer package called <code>versus.pkg</code> (388ac48764927fa353328104d5a32ad825af51ce), containing two applications, <code>InstallerAlert.app</code> and <code>versus.app</code>, and a standalone binary called <code>zoom</code>, as well as a <code>postinstall.sh</code> script in the parent folder.</p>
<!-- raw HTML omitted -->
<p>
<figure>
  <img src="https://www.sentinelone.com/wp-content/uploads/2025/02/FlexibleFerret_4.jpg" alt="File contents of the FlexibleFerret dropper, versus.pkg " />
</figure>


</p>
<!-- raw HTML omitted -->
<p>File contents of the FlexibleFerret dropper, <em>versus.pkg</em></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>After grabbing elevated privileges, the installer package uses the postinstall script to drop and execute several components in <code>/var/tmp/</code>. The postinstall script is a bash script that also logs its progress to a file in the separate <code>/private/tmp/</code> folder called <code>postinstall.log</code>.</p>
<pre tabindex="0"><code>#!/bin/bash
# Log the start of the script
echo &#34;$(date): Running post-installation script...&#34; &gt;&gt; /tmp/postinstall.log

# Check if the zoom file exists and execute it
if [ -f /var/tmp/zoom ]; then
echo &#34;$(date): Zoom file exists, executing...&#34; &gt;&gt; /tmp/postinstall.log
/var/tmp/zoom &gt;&gt; /tmp/postinstall.log 2&gt;&amp;1 &amp;
else
echo &#34;$(date): Zoom file not found&#34; &gt;&gt; /tmp/postinstall.log
fi

# Wait for 2 seconds
sleep 2

# Open the InstallerAlert.app if it exists
if [ -d &#34;/var/tmp/InstallerAlert.app&#34; ]; then
echo &#34;$(date): Opening InstallerAlert.app...&#34; &gt;&gt; /tmp/postinstall.log
open &#34;/var/tmp/InstallerAlert.app&#34; &gt;&gt; /tmp/postinstall.log 2&gt;&amp;1
else
echo &#34;$(date): InstallerAlert.app not found&#34; &gt;&gt; /tmp/postinstall.log
fi

# Wait for 2 seconds
sleep 2

# Log the end of the script
echo &#34;$(date): Post-installation script completed.&#34; &gt;&gt; /tmp/postinstall.log

exit 0
</code></pre><!-- raw HTML omitted -->
<p>
<figure>
  <img src="https://www.sentinelone.com/wp-content/uploads/2025/02/FlexibleFerret_6.jpg" alt="FlexibleFerret components dropped in the hosts /var/tmp folder" />
</figure>


</p>
<!-- raw HTML omitted -->
<p>FlexibleFerret components dropped in the hosts <em>/var/tmp folder/</em></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>The fake <code>zoom</code> binary (ee7a557347a10f74696dc19512ccc5fcfca77bc5) reaches out to the domain <code>zoom.callservice[.]us</code>. (*Note: this is <strong>not</strong> a legitimate Zoom domain).</p>
<p>Meanwhile, the same script executes the <code>InstallerAlert.app</code>, whose primary function is to trick the user into thinking the malware is a legitimate application that failed to run by throwing an alert dialog with the error message “<em>This file is damaged and cannot be opened</em>”, a message that mimics the genuine warning message typically thrown by Gatekeeper.</p>
<!-- raw HTML omitted -->
<p>
<figure>
  <img src="https://www.sentinelone.com/wp-content/uploads/2025/02/FlexibleFerret_8.jpg" alt="Embedded strings in InstallerAlert to deceive victims that the malware did not execute " />
</figure>


</p>
<!-- raw HTML omitted -->
<p>Embedded strings in <em>InstallerAlert</em> to deceive victims that the malware did not execute</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>In the background, however, the malware installs a persistence item in the User’s Library LaunchAgents folder with the label <code>com.zoom.plist</code> (*Note: the genuine Zoom Launch services file is in fact <code>[~]/Library/LaunchAgents/us.zoom.ZoomDaemon.plist</code>).</p>
<!-- raw HTML omitted -->
<p>
<figure>
  <img src="https://www.sentinelone.com/wp-content/uploads/2025/02/FlexibleFerret_1.jpg" alt="Strings in the zoom binary for setting up persistence" />
</figure>


</p>
<!-- raw HTML omitted -->
<p>Strings in the <em>zoom</em> binary for setting up persistence</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>The LaunchAgent targets a further executable at the path <code>/private/var/tmp/logd</code>, again masquerading as a legitimate part of the OS (logd is part of the unified logging system but does not have a component at that path). At the time of writing, we were not able to obtain a copy of this file, which appears to be received from the currently non-responding C2.</p>
<!-- raw HTML omitted -->
<p>
<figure>
  <img src="https://www.sentinelone.com/wp-content/uploads/2025/02/FlexibleFerret_7.jpg" alt="Execution of FlexibleFerret noisily leaves a log in /private/tmp" />
</figure>


</p>
<!-- raw HTML omitted -->
<p>Execution of FlexibleFerret noisily leaves a log in <em>/private/tmp/</em></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="flexibleferret--installeralert-and-ties-to-chromeupdate">FlexibleFerret | InstallerAlert and Ties to ChromeUpdate</h2>
<p>What ties these components to Apple’s recent FERRET rules and the samples previously reported is the <code>Mac-Installer.InstallerAlert</code> binary inside the <code>InstallerAlert.app</code>. This binary is a functional match for the <code>ChromeUpdate</code> binary and bears an 86% similarity to it. It contains both strings and functions that are identical only to <code>ChromeUpdate</code> and other files identified by Apple’s signature as malware. Importantly, however, neither <code>InstallerAlert</code> nor any of the other binaries found in the malicious <code>versus.pkg</code> are recognized as malware by XProtect.</p>
<p>Further, unlike <code>ChromeUpdate</code>, <code>InstallerAlert</code> is signed with a now-revoked Developer signature and Team ID. Pivoting off this signature allowed us to find several other samples of FlexibleFerret that are recognized as malware by a number of security vendors including SentinelOne.</p>
<h2 id="contagious-interview-campaign-actively-targeting-github-developers">‘Contagious Interview’ Campaign Actively Targeting Github Developers</h2>
<p>As noted earlier, the FlexibleFerret malware is a component of the ‘Contagious Interview’ campaign that began at least as far back as November 2023. SentinelLABS has further observed threat actors continuing attempts to compromise developers with the <code>ffmpeg.sh</code> installer script by opening fake issues on legitimate developers’ repositories. In an example in late December, one ‘commenter’ left instructions leading to the download of FERRET family droppers.</p>
<!-- raw HTML omitted -->
<p>
<figure>
  <img src="https://www.sentinelone.com/wp-content/uploads/2025/02/FlexibleFerret_3.jpg" alt="A threat actor tries to trick Github users into downloading FERRET malware" />
</figure>


</p>
<!-- raw HTML omitted -->
<p>A threat actor tries to trick Github users into downloading FERRET malware</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>This suggests that the threat actors are happy to expand the vectors by which they deliver the malware beyond the specific targeting of job seekers to developers more generally.</p>
<h2 id="conclusion">Conclusion</h2>
<p>The ‘Contagious Interview’ campaign and the FERRET family of malware represent an ongoing and active campaign, with threat actors pivoting from signed applications to functionally similar unsigned versions as required. Diverse tactics help the threat actors deliver malware to a variety of targets in the developer community, both in targeted efforts and what appears to be more ‘scatter gun’ approaches via social media and code sharing sites like Github.</p>
<p>Along with industry peers, SentinelLABS continues to track and publicize this activity to help raise awareness and protect users. SentinelOne customers are protected from known malicious components used in this campaign by the Singularity platform.</p>
<p>To learn more about how SentinelOne can protect your macOS devices, contact us for more information or request a free demo.</p>
<h2 id="indicators-of-compromise">Indicators of Compromise</h2>
<p><strong>FrostyFerret ZIPS</strong><br>
203f7cfbf22b30408591e6148f5978350676268b VCam_ARM64.zip<br>
a25dff88aeeaaf9f956446151a9d786495e2c546 CameraAccess.zip<br>
aa172bdccb8c14f53c059c8433c539049b6c2cdd VCam_x86_64.zip</p>
<p><strong>XProtect_FrostyFerret_UI</strong><br>
7da429f6d2cdd8a63b3930074797b990c02dc108<br>
7e07765bf8ee2d0b2233039623016d6dfb610a6d<br>
828a323b92b24caa5f5e3eff438db4556d15f215<br>
831cdcde47b4edbe27524085a6706fbfb9526cef<br>
8667078a88dae5471f50473a332f6c80b583d3de<br>
dba1454fbea1dd917712fbece9d6725244119f83<br>
e876ba6e23e09206f358dbd3a3642a7fd311bb22</p>
<p><strong>XProtect_FriendlyFerret_SECD</strong><br>
17e3906f6c4c97b6f5d10e0e0e7f2a2e2c97ca54<br>
2e51218985afcaa18eadc5775e6b374c78e2d85f<br>
7e07765bf8ee2d0b2233039623016d6dfb610a6d<br>
de3f83af6897a124d1e85a65818a80570b33c47c</p>
<p><strong>FlexibleFerret Installer</strong><br>
388ac48764927fa353328104d5a32ad825af51ce  versus.pkg</p>
<p><strong>FlexibleFerret Mach-Os</strong><br>
1a28013e4343fddf13e5c721f91970e942073b88 InstallerAlert<br>
3e16c6489bac4ac2d76c555eb1c263cd7e92c9a5 InstallerAlert<br>
76e3cb7be778f22d207623ce1907c1659f2c8215 InstallerAlert<br>
b0caf49884d68f72d2a62aa32d5edf0e79fd9de1 InstallerAlert<br>
bd73a1c03c24a8cdd744d8a513ae8d2ddfa2de5f InstallerAlert<br>
ccac0f0ba463c414b26ba67b5a3ddaabdef6d371 InstallerAlert<br>
d8245cdf6f51216f29a71f25e70de827186bdf71 InstallerAlert</p>
<p>b071fbd9c42ff660e3f240e1921533e40f0067eb Mac-Installer.AlertMsg<br>
ee7a557347a10f74696dc19512ccc5fcfca77bc5 zoom</p>
<p><strong>FlexibleFerret Signer</strong><br>
Name: Liseth Alejandra Trujillo Garcia<br>
Team Identifier: 58CD8AD5Z4<br>
Dev Identifier: VFYPGAKSLY</p>
<p><strong>FlexibleFerret Bundle Ids</strong><br>
Mac-Installer.AlertMsg<br>
Mac-Installer.InstallerAlert</p>
<p><strong>FlexibleFerret DNS Domain</strong><br>
zoom.callservice[.]us</p>
<p>Go to Source</p>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2025-03-20-srsly-risky-biz-chinas-mss-gets-persona/">Srsly Risky Biz Chinas MSS gets personal</a></li>
				
				<li><a href="/posts/2025-03-19-risky-bulletin-google-buys-wiz-for-32-b/">Risky Bulletin Google buys Wiz for 32 billion</a></li>
				
				<li><a href="/posts/apple-inc-sent-you-a-payment-request-payoneer-invoices-other-microsoft-enabled-scams/">“Apple Inc sent you a payment request” Payoneer invoices; other Microsoft-enabled scams</a></li>
				
				<li><a href="/posts/glasses-that-transcribe-text-to-audio/">“Glasses” That Transcribe Text To Audio</a></li>
				
				<li><a href="/posts/5-best-linux-centos-replacement-options-alternatives/">&lt;div&gt;5 Best Linux CentOS Replacement Options &amp; Alternatives&lt;/div&gt;</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
