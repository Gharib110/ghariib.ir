<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>2021-046-Mick Douglas Log4j vulnerabilities egress mitigations- part2</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>2021-046-Mick Douglas Log4j vulnerabilities egress mitigations- part2</h1>
			<b><time>23.12.2021 03:37</time></b>
		       

			<div>
				<h1 id="2021-046-mick-douglas-log4j-vulnerabilities-egress-mitigations--part2">2021-046-Mick Douglas Log4j vulnerabilities egress mitigations- part2</h1>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Overview of Log4j vuln (as of 16 December 2021)</p>
<p>Why is it a big deal? (impact/criticality/risk)</p>
<p>Talk about patching vs. mitigation</p>
<p>why wasn’t this given the same visibility in 2009? Because it’s Oracle or Java?</p>
<p>Good callout is building slides to brief org leadership, detections, and other educational tools.</p>
<p>Vuln fatigue (Java vulns in 2009 and pretty much forever cause us fatigue)</p>
<p>Are there other technologies like log4j that prop up the entire world, and we just don’t know?</p>
<p>Egress traffic (discussed at length on twitter, what problems it solve?)</p>
<p><a href="https://twitter.com/mubix/status/1470430085169745920">https://twitter.com/mubix/status/1470430085169745920</a></p>
<p>Latest: <a href="https://www.theregister.com/2021/12/14/apache_log4j_v2_16_jndi_disabled_default/">https://www.theregister.com/2021/12/14/apache_log4j_v2_16_jndi_disabled_default/</a> - apache removed JDNI functionality</p>
<p><a href="https://www.reddit.com/r/blueteamsec/comments/rd38z9/log4j_0day_being_exploited/">https://www.reddit.com/r/blueteamsec/comments/rd38z9/log4j_0day_being_exploited/</a> &lt;- great aggregation</p>
<p><a href="https://www.techsolvency.com/story-so-far/cve-2021-44228-log4j-log4shell/?fbclid=IwAR1ngTChJGz7Q5M-qbH6nwPBV4FByPDfJb98iLt_dbQO4EpZXVDwAxz0F8w">https://www.techsolvency.com/story-so-far/cve-2021-44228-log4j-log4shell/</a></p>
<p><a href="https://issues.apache.org/jira/plugins/servlet/mobile#issue/LOG4J2-313">https://issues.apache.org/jira/plugins/servlet/mobile#issue/LOG4J2-313</a></p>
<p>Lots of discussion about “SBOM solving the issue”. @K8em0 weighs in <a href="https://twitter.com/k8em0/status/1469437490691932164">https://twitter.com/k8em0/status/1469437490691932164</a></p>
<p><a href="https://gist.github.com/SwitHak/b66db3a06c2955a9cb71a8718970c592">https://gist.github.com/SwitHak/b66db3a06c2955a9cb71a8718970c592</a> -list of advisories for log4j</p>
<p>Mitigation: <a href="https://twitter.com/brunoborges/status/1469186875608875011">https://twitter.com/brunoborges/status/1469186875608875011</a><br>
<a href="https://twitter.com/DannyThomas/status/1469709039911129088">https://twitter.com/DannyThomas/status/1469709039911129088</a> (holy hell, 2009?!?)</p>
<p>2009 in fact, #CVE-2009-1094, then a bypass was fixed in CVE-2018-3149: <a href="https://t.co/5TR5g9vqo5">https://bugzilla.redhat.com/show_bug.cgi?id=1639834</a>. That&rsquo;s when the JDK was fully protected, but other implementations remained vulnerable</p>
<p><a href="https://bugzilla.redhat.com/show_bug.cgi?id=1639834">https://bugzilla.redhat.com/show_bug.cgi?id=1639834</a></p>
<p>OpenJDK… </p>
<p><a href="https://twitter.com/ThinkstCanary/status/1469439743905697797?s=20">https://twitter.com/ThinkstCanary/status/1469439743905697797?s=20</a> </p>
<p>You can use a point &amp; click canarytoken from <a href="https://canarytokens.org">https://canarytokens.org</a> to help test for the #log4j  / #Log4Shell issue.</p>
<ol>
<li>
<p>visit <a href="https://canarytokens.org">https://canarytokens.org</a>;</p>
</li>
<li>
<p>choose the Log4shell token;</p>
</li>
<li>
<p>enter the email address you wish to be notified at;</p>
</li>
<li>
<p>copy/use the returned string&hellip;</p>
</li>
</ol>
<p>Discussed in 2016 at Blackhat: <a href="https://twitter.com/th3_protoCOL/status/1469644923028656130">https://twitter.com/th3_protoCOL/status/1469644923028656130</a></p>
<p>The <a href="https://twitter.com/hashtag/Log4Shell?src=hashtag_click">#Log4Shell</a> attack vector was known since 2016… </p>
<p><a href="https://twitter.com/bettersafetynet/status/1469470284977745932">https://twitter.com/bettersafetynet/status/1469470284977745932</a></p>
<p>Just got off phone with a client. Log4j is in their network. Vendor claims patch will be available next release&hellip; which is multiple months from now. Here&rsquo;s what you do if you&rsquo;re in this situation. 1. Keep calm. There&rsquo;s no need to panic. 2. Carefully read this thread.</p>
<p>When dealing with attacks like this you should remember the acronym IMMA. </p>
<p>I = Isolate </p>
<p>M = Minimize </p>
<p>M = Monitor </p>
<p>A = Active Defense</p>
<p><a href="https://github.com/MarkBaggett/srum-dump">https://github.com/MarkBaggett/srum-dump</a></p>
<p>“SRUM Dump extracts information from the System Resource Utilization Management Database and creates a Excel spreadsheet.</p>
<p>The SRUM is one of the best sources for applications that have run on your system in the last 30 days and is invaluable to your incident investigations!</p>
<p>To use the tool you will need a copy of the SRUM (located in c:\windows\system32\sru\srudb.dat, but locked by the OS).</p>
<p>This tool also requires a SRUM_TEMPLATE that defines table and field names. You can optionally provide the SOFTWARE registry hive and the tool will tell you which wireless networks were in use by applications.</p>
<p>If you are looking for a version of this tool that creates CSV files instead of an Excel spreadsheet, dumps targeted tables or processes any ese then check out <a href="https://github.com/MarkBaggett/ese-analyst">ese2csv.</a> ese2csv.exe is designed specifically for csv files with the CLI user in mind.”</p>
<p><a href="https://support.microsoft.com/en-us/office/digitally-sign-your-macro-project-956e9cc8-bbf6-4365-8bfa-98505ecd1c01">https://support.microsoft.com/en-us/office/digitally-sign-your-macro-project-956e9cc8-bbf6-4365-8bfa-98505ecd1c01</a></p>
<h4 id="source"><a href="http://brakeingsecurity.com/2021-046">Source</a></h4>
<!-- raw HTML omitted -->

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2025-03-20-laser-harp-sets-the-tone/">Laser Harp Sets the Tone</a></li>
				
				<li><a href="/posts/2025-03-20-arduino-device-helps-split-the-g-on-a-p/">Arduino device helps split the G on a pint of Guinness</a></li>
				
				<li><a href="/posts/2025-03-20-the-70-best-early-amazon-spring-sale-ga/">The 70 best early Amazon Spring Sale gaming deals 2025</a></li>
				
				<li><a href="/posts/2025-03-20-tomorrow-and-tomorrow-and-tomorrow-info/">Tomorrow and tomorrow and tomorrow Information security and the Baseball Hall of Fame</a></li>
				
				<li><a href="/posts/2025-03-20-i-found-an-android-phone-that-can-convi/">I found an Android phone that can convince iPhone users to make the switch - and its not a flagship</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
