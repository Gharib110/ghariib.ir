<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>Lumma Stealer on the Rise: How Telegram Channels Are Fueling Malware Proliferation</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>Lumma Stealer on the Rise: How Telegram Channels Are Fueling Malware Proliferation</h1>
			<b><time>03.01.2025 00:00</time></b>
		       

			<div>
				<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/09/300x200_Blog_042723.png" alt="" />
</figure>


</p>
<p><em>Authored by: M.</em></p>
<p><em>Authored by: M, Mohanasundaram and Neil Tyagi</em></p>
<p>In today’s rapidly evolving cyber landscape, malware threats continue to adapt, employing new tactics and leveraging popular platforms to reach unsuspecting victims. One such emerging threat is the <em>Lumma Stealer</em>—a potent information-stealing malware recently gaining traction through Telegram channels. With Telegram’s popularity as a messaging and sharing platform, threat actors have identified it as a lucrative distribution vector, bypassing traditional detection mechanisms and reaching a broad, often unsuspecting audience.</p>
<p>Fortunately, McAfee’s advanced security solutions are equipped to detect and mitigate threats like Lumma Stealer. Through cutting-edge threat intelligence, behavioral analysis, and real-time monitoring, McAfee provides robust defenses against this malware, helping users secure their personal data and digital assets. In this blog, we will explore the tactics, techniques, and procedures (TTPs) used by Lumma Stealer, examine its capabilities, and discuss how McAfee solutions can help safeguard users from this rapidly spreading threat.</p>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/2.jpg" alt="" />
</figure>


</p>
<ul>
<li>Telegram channel offering malware disguised as crack software</li>
<li>https[:]//t[.]me/hitbase</li>
<li>Notice the high subscriber count of 42k.</li>
<li>Last post on 3rd Nov</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/1.jpg" alt="" />
</figure>


</p>
<ul>
<li>
<p>Another example of a telegram channel offering malware to benign users.</p>
</li>
<li>
<p>https[:]//t[.]me/sharmamod</p>
</li>
<li>
<p>Subscriber count 8.66k</p>
</li>
<li>
<p>Last post on 3rd Nov</p>
</li>
<li>
<p>Also notice that both the channels are related as they are forwarding messages from each other’s telegram channel.</p>
</li>
<li>
<p>McAfee detects these fake crack software as [Trojan:Win/Lummastealer.SD]</p>
</li>
<li>
<p>Threat Prevalence observed as per McAfee telemetry data.</p>
</li>
<li>
<p>India is most affected by this threat, followed by the USA and Europe.</p>
</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/2.5.jpg" alt="" />
</figure>


</p>
<ul>
<li>This blog will dissect one specific file, CCleaner 2024.rar. The others are similar in nature except for the theme.</li>
<li>The hash for this file is 3df7a19969e54bd60944372e925ad2fb69503df7159127335f792ad82db7da0b.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/3.jpg" alt="" />
</figure>


</p>
<ul>
<li>The extracted rar contains Microsoft DLL files</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/4.jpg" alt="" />
</figure>


</p>
<ul>
<li>Readme.txt contains the link to the telegram channel</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/5.jpg" alt="" />
</figure>


</p>
<ul>
<li>CCleaner 2024.exe is a .NET application</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/6.jpg" alt="" />
</figure>


</p>
<ul>
<li>We load the file into Dnspy and check the main function.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/7.jpg" alt="" />
</figure>


</p>
<ul>
<li>In this, we have two calls to a function UninitializeBuilder, which decrypts the blob of data that is passed to it (AIOsncoiuuA &amp; UserBuffer) along with the key (Alco and key).</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/8.jpg" alt="" />
</figure>


</p>
<ul>
<li>Decryption Key (Alco) and Encrypted data (AIOsncoiuuA) for the first call.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/9.jpg" alt="" />
</figure>


</p>
<ul>
<li>Decryption Key (Key) and Encrypted data (UserBuffer) for the Second call.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/10.jpg" alt="" />
</figure>


</p>
<ul>
<li>Snippet of the decryption Function.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/11.jpg" alt="" />
</figure>


</p>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/12.jpg" alt="" />
</figure>


</p>
<ul>
<li>Decrypted data is saved into variable uiOAshyuxgYUA.</li>
<li>We put a breakpoint on the end of this function and run the program to get the decrypted value of each call.</li>
<li>For the first call, we get the following decrypted data in memory. We see process injection API calls were decrypted in memory.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/13.jpg" alt="" />
</figure>


</p>
<ul>
<li>We can also see the target program in which the process injection will take place, in this case, RegAsm.exe.</li>
<li>We can confirm this through the process tree.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/14.jpg" alt="" />
</figure>


</p>
<ul>
<li>We let the breakpoint hit again to get the next layer decrypted PE file</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/15.jpg" alt="" />
</figure>


</p>
<ul>
<li>We can observe the decrypted PE bytes, dump this payload to disk, and inspect the next stage.</li>
<li>Stage1 is a V C++ compiled file.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/16.jpg" alt="" />
</figure>


</p>
<ul>
<li>We checked the payload sections and discovered that it holds encrypted data.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/17-1.jpg" alt="" />
</figure>


</p>
<ul>
<li>Snippet of the decryption loop.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/18.jpg" alt="" />
</figure>


</p>
<ul>
<li>Following decryption, the data is written to two files in the AppData Roaming folder.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/19.jpg" alt="" />
</figure>


</p>
<ul>
<li>The first payload written in the AppDataRoaming folder is the .NET file “XTb9DOBjB3.exe”(Lumma_stealer) and the second payload also .Net file “bTkEBBlC4H.exe”(clipper).</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/20.jpg" alt="" />
</figure>


</p>
<ul>
<li>Upon examining both payloads, we observed that they employ the same decryption logic as the main file(ccleaner).</li>
</ul>
<p>Lumma stealer:</p>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/21.jpg" alt="" />
</figure>


</p>
<ul>
<li>After dumping the payload from the .NET file, we discovered it is a 32-bit GUI Portable Executable.</li>
<li>“winhttp.dll is dynamically loaded into the program using the LoadLibraryExW function.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/22.jpg" alt="" />
</figure>


</p>
<ul>
<li>Upon inspecting the PE file, Base64-encoded strings were identified within the binary.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/23.jpg" alt="" />
</figure>


</p>
<ul>
<li>The encoded data is first decoded from Base64 format, converting it back into binary. The decoded data is then passed through a decryption routine to recover the plaintext.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/24.jpg" alt="" />
</figure>


</p>
<ul>
<li>We observe that the Plaintext resembles a domain, and it’s used to establish communication with a threat actor to exfiltrate the data.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/25.jpg" alt="" />
</figure>


</p>
<ul>
<li>Code snippet for WinHttpOpenRequest:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/26.jpg" alt="" />
</figure>


</p>
<p>List of Requests with post method:</p>
<ul>
<li>“hxxps://snarlypagowo.site/api”</li>
<li>“hxxps://questionsmw.store/api”</li>
<li>“hxxps://soldiefieop.site/api”</li>
<li>“hxxps://abnomalrkmu.site/api”</li>
<li>“hxxps://chorusarorp.site/api”</li>
<li>“hxxps://treatynreit.site/api”</li>
<li>“hxxps://mysterisop.site/api”</li>
<li>“hxxps://absorptioniw.site/api”</li>
</ul>
<p>At last, it connects to the steam community</p>
<ul>
<li>(hxxps://steamcommunity.com/profiles/76561199724331900),</li>
</ul>
<p>The malware extracts the Steam account name, initially obfuscated to evade detection, and decodes it to reveal the C2 domain. This step is essential for establishing a connection between the compromised device and the attacker’s server, allowing further malicious activity such as data exfiltration and additional payload delivery. By using this technique, the attackers effectively bypass basic detection mechanisms, making it harder for traditional security solutions to identify the communication with the C2 server.</p>
<ul>
<li>This is the snippet of the Steam community:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/27.jpg" alt="" />
</figure>


</p>
<ul>
<li>Upon checking the data, it was observed that the user’s name was obfuscated and had many aliases. We observed that the actual_persona_name fetched and it deobfuscated by the below code.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/28.jpg" alt="" />
</figure>


</p>
<ul>
<li>
<p>Upon de-obfuscation, we found the plain text and its domain <strong>“marshal-zhukov.com”</strong>.</p>
</li>
<li>
<p>Upon establishing a connection, the C2 server responded with configuration data in Base64 encoded format. The encoded data is first decoded from Base64 format, converting it back into binary. The decoded data is then passed through a decryption routine to recover the plaintext.</p>
</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/29.jpg" alt="" />
</figure>


</p>
<ul>
<li>Config for collecting wallet information.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/30.jpg" alt="" />
</figure>


</p>
<ul>
<li>For Browser information:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/31.jpg" alt="" />
</figure>


</p>
<ul>
<li>For FTP and email information:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/32.jpg" alt="" />
</figure>


</p>
<ul>
<li>It also collects system information and sends it to c2.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/33.jpg" alt="" />
</figure>


</p>
<ul>
<li>Clipper:</li>
<li>Once we dumped the payload from the .NET file, we found that it was a 32-bit .NET executable named “Runtime64.exe.”</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/34.jpg" alt="" />
</figure>


</p>
<ul>
<li>We load the file into dnspy and check the main function.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/35.jpg" alt="" />
</figure>


</p>
<ul>
<li>It begins by checking the mutex(“sodfksdkfalksdasgpkprgasdgrrkgwhrterheegwsdfwef”) to see if it’s already running on the machine.</li>
<li>Autorun.is_installed: This function checks if the program is set to run on system startup. If autorun is not configured, it adds one to enable automatic execution on startup.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/36.jpg" alt="" />
</figure>


</p>
<ul>
<li>
<p>This file sets the hidden attribute to false to remove the hidden status and set it as a system file to protect it.</p>
</li>
<li>
<p>This Clipboard Monitor.run function Uses the following regex patterns to match the wallet addresses.</p>
</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/37.jpg" alt="" />
</figure>


</p>
<ul>
<li>If it matches, it replaces the clipboard content with the specified address to hijack the cryptocurrency.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/38.jpg" alt="" />
</figure>


</p>
<ul>
<li>Code snippet for clipboard monitor and replacement:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/39.jpg" alt="" />
</figure>


</p>
<h2 id="conclusion"><strong>Conclusion</strong></h2>
<p>The Lumma Stealer is a stark reminder of the ever-evolving nature of cyber threats and the rapid adaptability of malware tactics. Its spread through Telegram channels demonstrates how easily threat actors can exploit popular platforms to distribute malicious code to a broad audience. With Lumma Stealer capable of stealing sensitive information and compromising user privacy, the potential damage it can cause is significant.</p>
<p>In this increasingly dangerous cyber landscape, having robust, up-to-date protection has never been more crucial. McAfee’s advanced threat detection and proactive defense mechanisms provide users with a vital safeguard against such threats. By combining real-time monitoring, behavioral analysis, and continuous updates to counter new TTPs, McAfee helps users stay one step ahead of malicious actors. As TTPs evolve rapidly, maintaining comprehensive antivirus protection is essential to safeguarding personal data, financial information, and privacy. Staying vigilant and equipped with the proper security solutions ensures that users are prepared to face the latest threats head-on.</p>
<p>Indicators of Compromise</p>
<table>
  <thead>
      <tr>
          <th>BLTools v4.5.5 New.rar</th>
          <th>000756bedf4e95de6781a4193301123032e987aba33dcd55c5e2a9de20a77418</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Blum Auto Bot Token.rar</td>
          <td>06715881cd4694a0de28f8d2e3a8cc17939e83a4ca4dee2ebb3078fc25664180</td>
      </tr>
      <tr>
          <td>Netflix Online Video 2024.rar</td>
          <td>072aa67c14d047621e0065e8529fadd0aac1c1324e10e5d027c10073fffcd023</td>
      </tr>
      <tr>
          <td>YouTube Downloader Version 2.1.6.rar</td>
          <td>1724f486563c5715ce1fe989e8f4ca01890970816c5ffc2e5d0221e38cf9fdb9</td>
      </tr>
      <tr>
          <td>Full Adobe Photoshop 2024 + CDkey.rar</td>
          <td>174690d86d36c648a2d5a595bc8cfae70c157f00c750c36fd1a29f52011af5e2</td>
      </tr>
      <tr>
          <td>Youtube Downloader Video 2024 Version.rar</td>
          <td>18aca8b28750c9673f1c467f5eab1bbae4ad6c79f3fe598318c203c8e664d44f</td>
      </tr>
      <tr>
          <td>ChatGPT-5 Version 2024 .rar</td>
          <td>24a32d763e458e5440cb18f87685cc5626bf62cd9c3ca7bab10f0ced629708ee</td>
      </tr>
      <tr>
          <td>Valorant Checker by Xinax 2024.rar</td>
          <td>31a818c75d35bafc58c62c7522503f90be7b684803883e5f07c4cc16f517d1d0</td>
      </tr>
      <tr>
          <td>Activation Windows 8,10,11 FULL + CDkey.rar</td>
          <td>338ec6016db4eb95b15bc0822fc1d745f107ae0739a57b41ef10c9f64b6c8077</td>
      </tr>
      <tr>
          <td>Ccleaner 2024.rar</td>
          <td>3df7a19969e54bd60944372e925ad2fb69503df7159127335f792ad82db7da0b</td>
      </tr>
      <tr>
          <td>CC Checker AcTeam 2024 New.rar</td>
          <td>535650b613161c011086eab9d87189aa637f8575e52442db6e81602e67a2e4f4</td>
      </tr>
      <tr>
          <td>Netflix mail access Checker 2024 New.rar</td>
          <td>61a17a91ce2a98b455a50ff37b33368fe3b2f3a516cf94c5d7b18e386274557b</td>
      </tr>
      <tr>
          <td>Paypal Checker New 2024 version.rar</td>
          <td>840a255a184d3e819a07e3749b5e32da84f607ac7025366967d12dac0c5fa859</td>
      </tr>
      <tr>
          <td>Free YouTube Downloader 2024.rar</td>
          <td>9be6ea9ab019c7bd59fab7097ceb9cd465a6ae0c6b9a50d55432a0bfb5e1f184</td>
      </tr>
      <tr>
          <td>Microsoft Office 2024 + CDkey.rar</td>
          <td>a541b66785534bca646a7691c7a2a5630947ecbd4ee2544b19a5f8347f70f923</td>
      </tr>
      <tr>
          <td>Crypto Seed Checker 2024 version.rar</td>
          <td>ac5c6793354b2be799ce755828d72f65a0c2ea63ccc942208c22e893a251b52c</td>
      </tr>
      <tr>
          <td>Phemex CryptoBot.rar</td>
          <td>b53e0759fa11d6d31b837adf5c5ceda40dd01aa331aa42256282f9ca46531f25</td>
      </tr>
      <tr>
          <td>SQLi Dumper v10.5.rar</td>
          <td>ce8e7b2a6222aa8678f0c73bd29a9e3a358f464310002684d7c46b2b9e8dcf23</td>
      </tr>
      <tr>
          <td>Cyber Ghost VPN + Key master.rar</td>
          <td>d31520c4a77f01f0491ef5ecf03c487975182de7264d7dce0fb7988e0cea7248</td>
      </tr>
      <tr>
          <td>AIO checker New Version 9.10.rar</td>
          <td>d67cc175e2bb94e2006f2700c1b052123961f5f64a18a00c8787c4aa6071146f</td>
      </tr>
      <tr>
          <td>Spotify Desktop Version 2024.rar</td>
          <td>e71e23ad0e5e8b289f1959579fb185c34961a644d0e24a7466265bef07eab8ec</td>
      </tr>
      <tr>
          <td>Nord VPN 2024 + Key.rar</td>
          <td>fa34c20e1de65bfff3c0e60d25748927aa83d3ea9f4029e59aaedb4801220a54</td>
      </tr>
      <tr>
          <td>Paysafecard Checker 2024 version.rar</td>
          <td>fb60510e8595b773abde86f6f1792890978cd6efc924c187cb664d49ef05a250</td>
      </tr>
      <tr>
          <td>TradingView 2024 New Version (Desktop).rar</td>
          <td>fdc6ebf3968cd2dfcc8ad05202a847d7f8b2a70746800fd240e6c5136fcd34f6</td>
      </tr>
      <tr>
          <td>Telegram channel</td>
          <td>·      https[:]//t[.]me/hitbase</td>
      </tr>
      <tr>
          <td>Telegram channel</td>
          <td>·      https[:]//t[.]me/sharmamod</td>
      </tr>
      <tr>
          <td>C2</td>
          <td>marshal-zhukov.com</td>
      </tr>
  </tbody>
</table>
<p><em>Mohanasundaram and Neil Tyagi</em></p>
<p>In today’s rapidly evolving cyber landscape, malware threats continue to adapt, employing new tactics and leveraging popular platforms to reach unsuspecting victims. One such emerging threat is the <em>Lumma Stealer</em>—a potent information-stealing malware recently gaining traction through Telegram channels. With Telegram’s popularity as a messaging and sharing platform, threat actors have identified it as a lucrative distribution vector, bypassing traditional detection mechanisms and reaching a broad, often unsuspecting audience.</p>
<p>Fortunately, McAfee’s advanced security solutions are equipped to detect and mitigate threats like Lumma Stealer. Through cutting-edge threat intelligence, behavioral analysis, and real-time monitoring, McAfee provides robust defenses against this malware, helping users secure their personal data and digital assets. In this blog, we will explore the tactics, techniques, and procedures (TTPs) used by Lumma Stealer, examine its capabilities, and discuss how McAfee solutions can help safeguard users from this rapidly spreading threat.</p>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/2.jpg" alt="" />
</figure>


</p>
<ul>
<li>Telegram channel offering malware disguised as crack software</li>
<li>https[:]//t[.]me/hitbase</li>
<li>Notice the high subscriber count of 42k.</li>
<li>Last post on 3rd Nov</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/1.jpg" alt="" />
</figure>


</p>
<ul>
<li>
<p>Another example of a telegram channel offering malware to benign users.</p>
</li>
<li>
<p>https[:]//t[.]me/sharmamod</p>
</li>
<li>
<p>Subscriber count 8.66k</p>
</li>
<li>
<p>Last post on 3rd Nov</p>
</li>
<li>
<p>Also notice that both the channels are related as they are forwarding messages from each other’s telegram channel.</p>
</li>
<li>
<p>McAfee detects these fake crack software as [Trojan:Win/Lummastealer.SD]</p>
</li>
<li>
<p>Threat Prevalence observed as per McAfee telemetry data.</p>
</li>
<li>
<p>India is most affected by this threat, followed by the USA and Europe.</p>
</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/2.5.jpg" alt="" />
</figure>


</p>
<ul>
<li>This blog will dissect one specific file, CCleaner 2024.rar. The others are similar in nature except for the theme.</li>
<li>The hash for this file is 3df7a19969e54bd60944372e925ad2fb69503df7159127335f792ad82db7da0b.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/3.jpg" alt="" />
</figure>


</p>
<ul>
<li>The extracted rar contains Microsoft DLL files</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/4.jpg" alt="" />
</figure>


</p>
<ul>
<li>Readme.txt contains the link to the telegram channel</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/5.jpg" alt="" />
</figure>


</p>
<ul>
<li>CCleaner 2024.exe is a .NET application</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/6.jpg" alt="" />
</figure>


</p>
<ul>
<li>We load the file into Dnspy and check the main function.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/7.jpg" alt="" />
</figure>


</p>
<ul>
<li>In this, we have two calls to a function UninitializeBuilder, which decrypts the blob of data that is passed to it (AIOsncoiuuA &amp; UserBuffer) along with the key (Alco and key).</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/8.jpg" alt="" />
</figure>


</p>
<ul>
<li>Decryption Key (Alco) and Encrypted data (AIOsncoiuuA) for the first call.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/9.jpg" alt="" />
</figure>


</p>
<ul>
<li>Decryption Key (Key) and Encrypted data (UserBuffer) for the Second call.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/10.jpg" alt="" />
</figure>


</p>
<ul>
<li>Snippet of the decryption Function.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/11.jpg" alt="" />
</figure>


</p>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/12.jpg" alt="" />
</figure>


</p>
<ul>
<li>Decrypted data is saved into variable uiOAshyuxgYUA.</li>
<li>We put a breakpoint on the end of this function and run the program to get the decrypted value of each call.</li>
<li>For the first call, we get the following decrypted data in memory. We see process injection API calls were decrypted in memory.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/13.jpg" alt="" />
</figure>


</p>
<ul>
<li>We can also see the target program in which the process injection will take place, in this case, RegAsm.exe.</li>
<li>We can confirm this through the process tree.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/14.jpg" alt="" />
</figure>


</p>
<ul>
<li>We let the breakpoint hit again to get the next layer decrypted PE file</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/15.jpg" alt="" />
</figure>


</p>
<ul>
<li>We can observe the decrypted PE bytes, dump this payload to disk, and inspect the next stage.</li>
<li>Stage1 is a V C++ compiled file.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/16.jpg" alt="" />
</figure>


</p>
<ul>
<li>We checked the payload sections and discovered that it holds encrypted data.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/17-1.jpg" alt="" />
</figure>


</p>
<ul>
<li>Snippet of the decryption loop.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/18.jpg" alt="" />
</figure>


</p>
<ul>
<li>Following decryption, the data is written to two files in the AppData Roaming folder.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/19.jpg" alt="" />
</figure>


</p>
<ul>
<li>The first payload written in the AppDataRoaming folder is the .NET file “XTb9DOBjB3.exe”(Lumma_stealer) and the second payload also .Net file “bTkEBBlC4H.exe”(clipper).</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/20.jpg" alt="" />
</figure>


</p>
<ul>
<li>Upon examining both payloads, we observed that they employ the same decryption logic as the main file(ccleaner).</li>
</ul>
<p>Lumma stealer:</p>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/21.jpg" alt="" />
</figure>


</p>
<ul>
<li>After dumping the payload from the .NET file, we discovered it is a 32-bit GUI Portable Executable.</li>
<li>“winhttp.dll is dynamically loaded into the program using the LoadLibraryExW function.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/22.jpg" alt="" />
</figure>


</p>
<ul>
<li>Upon inspecting the PE file, Base64-encoded strings were identified within the binary.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/23.jpg" alt="" />
</figure>


</p>
<ul>
<li>The encoded data is first decoded from Base64 format, converting it back into binary. The decoded data is then passed through a decryption routine to recover the plaintext.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/24.jpg" alt="" />
</figure>


</p>
<ul>
<li>We observe that the Plaintext resembles a domain, and it’s used to establish communication with a threat actor to exfiltrate the data.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/25.jpg" alt="" />
</figure>


</p>
<ul>
<li>Code snippet for WinHttpOpenRequest:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/26.jpg" alt="" />
</figure>


</p>
<p>List of Requests with post method:</p>
<ul>
<li>“hxxps://snarlypagowo.site/api”</li>
<li>“hxxps://questionsmw.store/api”</li>
<li>“hxxps://soldiefieop.site/api”</li>
<li>“hxxps://abnomalrkmu.site/api”</li>
<li>“hxxps://chorusarorp.site/api”</li>
<li>“hxxps://treatynreit.site/api”</li>
<li>“hxxps://mysterisop.site/api”</li>
<li>“hxxps://absorptioniw.site/api”</li>
</ul>
<p>At last, it connects to the steam community</p>
<ul>
<li>(hxxps://steamcommunity.com/profiles/76561199724331900),</li>
</ul>
<p>The malware extracts the Steam account name, initially obfuscated to evade detection, and decodes it to reveal the C2 domain. This step is essential for establishing a connection between the compromised device and the attacker’s server, allowing further malicious activity such as data exfiltration and additional payload delivery. By using this technique, the attackers effectively bypass basic detection mechanisms, making it harder for traditional security solutions to identify the communication with the C2 server.</p>
<ul>
<li>This is the snippet of the Steam community:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/27.jpg" alt="" />
</figure>


</p>
<ul>
<li>Upon checking the data, it was observed that the user’s name was obfuscated and had many aliases. We observed that the actual_persona_name fetched and it deobfuscated by the below code.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/28.jpg" alt="" />
</figure>


</p>
<ul>
<li>
<p>Upon de-obfuscation, we found the plain text and its domain <strong>“marshal-zhukov.com”</strong>.</p>
</li>
<li>
<p>Upon establishing a connection, the C2 server responded with configuration data in Base64 encoded format. The encoded data is first decoded from Base64 format, converting it back into binary. The decoded data is then passed through a decryption routine to recover the plaintext.</p>
</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/29.jpg" alt="" />
</figure>


</p>
<ul>
<li>Config for collecting wallet information.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/30.jpg" alt="" />
</figure>


</p>
<ul>
<li>For Browser information:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/31.jpg" alt="" />
</figure>


</p>
<ul>
<li>For FTP and email information:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/32.jpg" alt="" />
</figure>


</p>
<ul>
<li>It also collects system information and sends it to c2.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/33.jpg" alt="" />
</figure>


</p>
<ul>
<li>Clipper:</li>
<li>Once we dumped the payload from the .NET file, we found that it was a 32-bit .NET executable named “Runtime64.exe.”</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/34.jpg" alt="" />
</figure>


</p>
<ul>
<li>We load the file into dnspy and check the main function.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/35.jpg" alt="" />
</figure>


</p>
<ul>
<li>It begins by checking the mutex(“sodfksdkfalksdasgpkprgasdgrrkgwhrterheegwsdfwef”) to see if it’s already running on the machine.</li>
<li>Autorun.is_installed: This function checks if the program is set to run on system startup. If autorun is not configured, it adds one to enable automatic execution on startup.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/36.jpg" alt="" />
</figure>


</p>
<ul>
<li>
<p>This file sets the hidden attribute to false to remove the hidden status and set it as a system file to protect it.</p>
</li>
<li>
<p>This Clipboard Monitor.run function Uses the following regex patterns to match the wallet addresses.</p>
</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/37.jpg" alt="" />
</figure>


</p>
<ul>
<li>If it matches, it replaces the clipboard content with the specified address to hijack the cryptocurrency.</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/38.jpg" alt="" />
</figure>


</p>
<ul>
<li>Code snippet for clipboard monitor and replacement:</li>
</ul>
<p>
<figure>
  <img src="https://www.mcafee.com/blogs/wp-content/uploads/2024/11/39.jpg" alt="" />
</figure>


</p>
<h2 id="conclusion-1"><strong>Conclusion</strong></h2>
<p>The Lumma Stealer is a stark reminder of the ever-evolving nature of cyber threats and the rapid adaptability of malware tactics. Its spread through Telegram channels demonstrates how easily threat actors can exploit popular platforms to distribute malicious code to a broad audience. With Lumma Stealer capable of stealing sensitive information and compromising user privacy, the potential damage it can cause is significant.</p>
<p>In this increasingly dangerous cyber landscape, having robust, up-to-date protection has never been more crucial. McAfee’s advanced threat detection and proactive defense mechanisms provide users with a vital safeguard against such threats. By combining real-time monitoring, behavioral analysis, and continuous updates to counter new TTPs, McAfee helps users stay one step ahead of malicious actors. As TTPs evolve rapidly, maintaining comprehensive antivirus protection is essential to safeguarding personal data, financial information, and privacy. Staying vigilant and equipped with the proper security solutions ensures that users are prepared to face the latest threats head-on.</p>
<p>Indicators of Compromise</p>
<table>
  <thead>
      <tr>
          <th>BLTools v4.5.5 New.rar</th>
          <th>000756bedf4e95de6781a4193301123032e987aba33dcd55c5e2a9de20a77418</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Blum Auto Bot Token.rar</td>
          <td>06715881cd4694a0de28f8d2e3a8cc17939e83a4ca4dee2ebb3078fc25664180</td>
      </tr>
      <tr>
          <td>Netflix Online Video 2024.rar</td>
          <td>072aa67c14d047621e0065e8529fadd0aac1c1324e10e5d027c10073fffcd023</td>
      </tr>
      <tr>
          <td>YouTube Downloader Version 2.1.6.rar</td>
          <td>1724f486563c5715ce1fe989e8f4ca01890970816c5ffc2e5d0221e38cf9fdb9</td>
      </tr>
      <tr>
          <td>Full Adobe Photoshop 2024 + CDkey.rar</td>
          <td>174690d86d36c648a2d5a595bc8cfae70c157f00c750c36fd1a29f52011af5e2</td>
      </tr>
      <tr>
          <td>Youtube Downloader Video 2024 Version.rar</td>
          <td>18aca8b28750c9673f1c467f5eab1bbae4ad6c79f3fe598318c203c8e664d44f</td>
      </tr>
      <tr>
          <td>ChatGPT-5 Version 2024 .rar</td>
          <td>24a32d763e458e5440cb18f87685cc5626bf62cd9c3ca7bab10f0ced629708ee</td>
      </tr>
      <tr>
          <td>Valorant Checker by Xinax 2024.rar</td>
          <td>31a818c75d35bafc58c62c7522503f90be7b684803883e5f07c4cc16f517d1d0</td>
      </tr>
      <tr>
          <td>Activation Windows 8,10,11 FULL + CDkey.rar</td>
          <td>338ec6016db4eb95b15bc0822fc1d745f107ae0739a57b41ef10c9f64b6c8077</td>
      </tr>
      <tr>
          <td>Ccleaner 2024.rar</td>
          <td>3df7a19969e54bd60944372e925ad2fb69503df7159127335f792ad82db7da0b</td>
      </tr>
      <tr>
          <td>CC Checker AcTeam 2024 New.rar</td>
          <td>535650b613161c011086eab9d87189aa637f8575e52442db6e81602e67a2e4f4</td>
      </tr>
      <tr>
          <td>Netflix mail access Checker 2024 New.rar</td>
          <td>61a17a91ce2a98b455a50ff37b33368fe3b2f3a516cf94c5d7b18e386274557b</td>
      </tr>
      <tr>
          <td>Paypal Checker New 2024 version.rar</td>
          <td>840a255a184d3e819a07e3749b5e32da84f607ac7025366967d12dac0c5fa859</td>
      </tr>
      <tr>
          <td>Free YouTube Downloader 2024.rar</td>
          <td>9be6ea9ab019c7bd59fab7097ceb9cd465a6ae0c6b9a50d55432a0bfb5e1f184</td>
      </tr>
      <tr>
          <td>Microsoft Office 2024 + CDkey.rar</td>
          <td>a541b66785534bca646a7691c7a2a5630947ecbd4ee2544b19a5f8347f70f923</td>
      </tr>
      <tr>
          <td>Crypto Seed Checker 2024 version.rar</td>
          <td>ac5c6793354b2be799ce755828d72f65a0c2ea63ccc942208c22e893a251b52c</td>
      </tr>
      <tr>
          <td>Phemex CryptoBot.rar</td>
          <td>b53e0759fa11d6d31b837adf5c5ceda40dd01aa331aa42256282f9ca46531f25</td>
      </tr>
      <tr>
          <td>SQLi Dumper v10.5.rar</td>
          <td>ce8e7b2a6222aa8678f0c73bd29a9e3a358f464310002684d7c46b2b9e8dcf23</td>
      </tr>
      <tr>
          <td>Cyber Ghost VPN + Key master.rar</td>
          <td>d31520c4a77f01f0491ef5ecf03c487975182de7264d7dce0fb7988e0cea7248</td>
      </tr>
      <tr>
          <td>AIO checker New Version 9.10.rar</td>
          <td>d67cc175e2bb94e2006f2700c1b052123961f5f64a18a00c8787c4aa6071146f</td>
      </tr>
      <tr>
          <td>Spotify Desktop Version 2024.rar</td>
          <td>e71e23ad0e5e8b289f1959579fb185c34961a644d0e24a7466265bef07eab8ec</td>
      </tr>
      <tr>
          <td>Nord VPN 2024 + Key.rar</td>
          <td>fa34c20e1de65bfff3c0e60d25748927aa83d3ea9f4029e59aaedb4801220a54</td>
      </tr>
      <tr>
          <td>Paysafecard Checker 2024 version.rar</td>
          <td>fb60510e8595b773abde86f6f1792890978cd6efc924c187cb664d49ef05a250</td>
      </tr>
      <tr>
          <td>TradingView 2024 New Version (Desktop).rar</td>
          <td>fdc6ebf3968cd2dfcc8ad05202a847d7f8b2a70746800fd240e6c5136fcd34f6</td>
      </tr>
      <tr>
          <td>Telegram channel</td>
          <td>·      https[:]//t[.]me/hitbase</td>
      </tr>
      <tr>
          <td>Telegram channel</td>
          <td>·      https[:]//t[.]me/sharmamod</td>
      </tr>
      <tr>
          <td>C2</td>
          <td>marshal-zhukov.com</td>
      </tr>
  </tbody>
</table>
<p>The post Lumma Stealer on the Rise: How Telegram Channels Are Fueling Malware Proliferation appeared first on McAfee Blog.</p>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/apple-inc-sent-you-a-payment-request-payoneer-invoices-other-microsoft-enabled-scams/">“Apple Inc sent you a payment request” Payoneer invoices; other Microsoft-enabled scams</a></li>
				
				<li><a href="/posts/5-best-linux-centos-replacement-options-alternatives/">&lt;div&gt;5 Best Linux CentOS Replacement Options &amp; Alternatives&lt;/div&gt;</a></li>
				
				<li><a href="/posts/crm-database-explained-definition-benefits-best-practices/">&lt;div&gt;CRM Database Explained: Definition, Benefits &amp; Best Practices&lt;/div&gt;</a></li>
				
				<li><a href="/posts/crm-reports-key-features-benefits-how-to-create-them/">&lt;div&gt;CRM Reports: Key Features, Benefits &amp; How to Create Them&lt;/div&gt;</a></li>
				
				<li><a href="/posts/iphone-android-users-a-major-privacy-upgrade-is-coming-soon/">&lt;div&gt;iPhone &amp; Android Users: A Major Privacy Upgrade is Coming Soon&lt;/div&gt;</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
