<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>2017-013-Multi-factor Auth implementations gotchas and solutions with Matt</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>2017-013-Multi-factor Auth implementations gotchas and solutions with Matt</h1>
			<b><time>13.04.2017 03:03</time></b>
		       

			<div>
				<h1 id="2017-013-multi-factor-auth-implementations-gotchas-and-solutions-with-matt">2017-013-Multi-factor Auth implementations gotchas and solutions with Matt</h1>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>We also discuss it&rsquo;s use with concepts like &ldquo;beyondCorp&rdquo;, which is google&rsquo;s concept of &ldquo;Software Defined Perimeter&rdquo; that we talked about a few weeks ago with @jasonGarbis (<a href="http://traffic.libsyn.com/brakeingsecurity/2017-011-Software_Defined_Perimeter.mp3">http://traffic.libsyn.com/brakeingsecurity/2017-011-Software_Defined_Perimeter.mp3</a>)</p>
<p>This is a great discussion for people looking to implement 2FA at their organization, or need ammunition if your boss thinks that all security is solved by using Google Auth.</p>
<p>Direct Link: <a href="http://traffic.libsyn.com/brakeingsecurity/2017-013-Multi-factor_auth_gotchas_with_Matt.mp3">http://traffic.libsyn.com/brakeingsecurity/2017-013-Multi-factor_auth_gotchas_with_Matt.mp3</a></p>
<p>Youtube Channel:  <a href="https://www.youtube.com/channel/UCZFjAqFb4A60M1TMa0t1KXw">https://www.youtube.com/channel/UCZFjAqFb4A60M1TMa0t1KXw</a></p>
<p>iTunes Store Link:  <a href="https://itunes.apple.com/us/podcast/brakeing-down-security-podcast/id799131292?mt=2">https://itunes.apple.com/us/podcast/brakeing-down-security-podcast/id799131292?mt=2</a> </p>
<p>-&mdash;&mdash;&ndash;</p>
<p>Jay Beale’s Class “aikido on the command line: hardening and containment”</p>
<p><strong>JULY 22-23 &amp; JULY 24-25    AT BlackHat 2017</strong></p>
<p><a href="https://www.blackhat.com/us-17/training/aikido-on-the-command-line-linux-hardening-and-containment.html">https://www.blackhat.com/us-17/training/aikido-on-the-command-line-linux-hardening-and-containment.html</a></p>
<p>-&mdash;&mdash;&ndash;</p>
<p>Join our #Slack Channel! Sign up at <strong><a href="https://brakesec.signup.team">https://brakesec.signup.team</a></strong></p>
<p>#RSS: <a href="http://www.brakeingsecurity.com/rss">http://www.brakeingsecurity.com/rss</a></p>
<p>#Google Play Store: <a href="https://play.google.com/music/m/Ifp5boyverbo4yywxnbydtzljcy?t=Brakeing">https://play.google.com/music/m/Ifp5boyverbo4yywxnbydtzljcy?t=Brakeing</a>_Down_Security_podcast</p>
<p>#iHeartRadio App:  <a href="https://www.iheart.com/show/263-Brakeing-Down-Securi/">https://www.iheart.com/show/263-Brakeing-Down-Securi/</a></p>
<p>#SoundCloud: <a href="https://www.soundcloud.com/bryan-brake">https://www.soundcloud.com/bryan-brake</a></p>
<p>Comments, Questions, Feedback: <a href="mailto:bds.podcast@gmail.com">bds.podcast@gmail.com</a></p>
<p>Support Brakeing Down Security Podcast on #Patreon: <a href="https://www.patreon.com/bds_podcast">https://www.patreon.com/bds_podcast</a></p>
<p>#Twitter: @brakesec @boettcherpwned @bryanbrake</p>
<p>#Player.FM : <a href="https://player.fm/series/brakeing-down-security-podcast">https://player.fm/series/brakeing-down-security-podcast</a></p>
<p>#Stitcher Network: <a href="http://www.stitcher.com/s?fid=80546&amp;refid=stpr">http://www.stitcher.com/s?fid=80546&amp;refid=stpr</a></p>
<p>#TuneIn Radio App: <a href="http://tunein.com/radio/Brakeing-Down-Security-Podcast-p801582/">http://tunein.com/radio/Brakeing-Down-Security-Podcast-p801582/</a></p>
<p>Show Notes:</p>
<p>What does MFA try to solve:</p>
<ul>
<li>Mitigate password reuse</li>
<li>Cred theft - Someone stealing credentials from embarassingadultsite.com and turns they work out on a totallyserious.gov RDP server</li>
<li>Phishing bad - same as above, except now you convince someone totallyseriousgov.com is legit and they give you credentials</li>
</ul>
<p>Cred theft:</p>
<ul>
<li>Getting to the point where old mate literally has more password dumps than time</li>
<li><a href="https://www.troyhunt.com/i-just-added-another-140-data-breaches-to-have-i-been-pwned/">https://www.troyhunt.com/i-just-added-another-140-data-breaches-to-have-i-been-pwned/</a></li>
<li>Honestly not going away, and combined with password reuse makes things pretty bad</li>
</ul>
<p>Phishing:</p>
<ul>
<li>Happens.</li>
<li>META: do we need to back this up with some stats?  <a href="https://blog.barkly.com/phishing-statistics-2016">https://blog.barkly.com/phishing-statistics-2016</a></li>
</ul>
<p>MFA / Bad things happening with that:</p>
<ul>
<li>AU Telecommunications provider sent multifactor SMS to wrong people</li>
<li>
<ul>
<li><a href="https://www.itnews.com.au/news/telstra-sending-sms-to-wrong-numbers-after-exchange-fire-449690">https://www.itnews.com.au/news/telstra-sending-sms-to-wrong-numbers-after-exchange-fire-449690</a></li>
</ul>
</li>
<li>RSA was owned years ago - and had to reissue a bunch of tokens</li>
<li>
<ul>
<li><a href="http://money.cnn.com/2011/06/08/technology/securid_hack/">http://money.cnn.com/2011/06/08/technology/securid_hack/</a></li>
<li><a href="https://bits.blogs.nytimes.com/2011/04/02/the-rsa-hack-how-they-did-it/?_r=0">https://bits.blogs.nytimes.com/2011/04/02/the-rsa-hack-how-they-did-it/?_r=0</a></li>
<li>On the plus side, obviously increased cost to attacker significantly to do that</li>
</ul>
</li>
<li>Phishing frameworks are everywhere</li>
<li>
<ul>
<li>Misc / Turns out U2F makes phishing kind of dead? (Read first amendment)</li>
<li><a href="https://breakdev.org/evilginx-advanced-phishing-with-two-factor-authentication-bypass/">https://breakdev.org/evilginx-advanced-phishing-with-two-factor-authentication-bypass/</a></li>
<li>Appears Backed up by the spec ( ‘Origin’ / <a href="https://fidoalliance.org/specs/fido-u2f-v1.1-id-20160915/fido-u2f-overview-v1.1-id-20160915.pdf">https://fidoalliance.org/specs/fido-u2f-v1.1-id-20160915/fido-u2f-overview-v1.1-id-20160915.pdf</a>)</li>
</ul>
</li>
</ul>
<p>Phishing/2FA/Solutions?</p>
<ol>
<li>a) What does multifactor actually solve?</li>
<li>b) Are we (infosec industry) issuing multifactor solutions to people just so people make money?</li>
<li>c)  Do these things give a *false* sense of security?</li>
<li>d) What do you think about storing the token on the same box? Especially given an actor on the box is just going to steal creds as they’re entered.</li>
</ol>
<p>Internal training / is this actually working?</p>
<p>Australia Post didn&rsquo;t think so</p>
<p><a href="https://www.itnews.com.au/news/why-australia-post-ransomwared-its-own-staff-454987">https://www.itnews.com.au/news/why-australia-post-ransomwared-its-own-staff-454987</a></p>
<p>Counterpoints:</p>
<p>It&rsquo;s irritating and does break at times ( <a href="https://twitter.com/dguido/status/842448889697447938">https://twitter.com/dguido/status/842448889697447938</a> )</p>
<p>C: I don’t like running some silly app on my phone</p>
<p>C: I also don’t like running around with a physical token</p>
<p>C: Embedding a Yubico nano in my usb slot leaves me with one usb port left</p>
<p>Also doesn’t solve when someone just steals that token</p>
<p>Does any of it matter:</p>
<p>Beyondcorp / &ldquo;Lets make the machines state be part of the credential&rdquo;</p>
<p><a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/43231.pdf">https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/43231.pdf</a></p>
<ul>
<li>Tl;dr of paper: TPMs, certificates and a lot of health checks - think of NAC on steroids</li>
</ul>
<p>Is there some way we (not google) can make it so a credential is worthless?</p>
<p>Solutions:</p>
<p>Duo / “There&rsquo;s an app on my phone and it has context about what wants to do something right now”</p>
<p>Probably a step in the right direction</p>
<p>Kind of like some Aus banks which SMS you before transferring $X to Y account</p>
<p>Okta - (grab links to spec)</p>
<p>META // Does this actually solve it?</p>
<p>OAUTH - (grab links to spec)</p>
<p>Attacking OAUTH - <a href="https://dhavalkapil.com/blogs/Attacking-the-OAuth-Protocol/">https://dhavalkapil.com/blogs/Attacking-the-OAuth-Protocol/</a></p>
<p>META // It’s not MFA, but it makes the cost of unrelated compromise significantly lower</p>
<p>META // Engineering things to short lived secrets is a better idea</p>
<p>I think one of the better ideas being put out was by google in 2014, the ‘beyondcorp’ project (<a href="https://research.google.com/pubs/pub43231.html)">https://research.google.com/pubs/pub43231.html)</a>, simply put:</p>
<ul>
<li>The devices used everywhere are chromebooks run in standard mode rather than developer mode</li>
<li>
<ul>
<li>(Whitelisting For Free™)</li>
</ul>
</li>
<li>Everything is a web app</li>
<li>Everything else can’t run due to app whitelisting built-in</li>
<li>The device needs to also authenticate before the user can do anything, and is used as part of the judgement for access control engines</li>
<li>Everything cares about the machine the user is using - It’s part of the credential</li>
<li>Passwords are no longer important and it’s all single sign on</li>
<li>
<ul>
<li>Suddenly credential theft doesn’t matter</li>
</ul>
</li>
<li>The device uses certificates to attest to its current state, so stolen passwords without a valid device don’t matter</li>
<li>As the device is a glorified web browser, and has app whitelisting, you’re not going to get code execution on it, malware no longer matters</li>
<li>
<ul>
<li>Caveat, someone will probably think of some cool technique and that’ll ruin everything</li>
<li>See: Problem of induction / “Black swan event”</li>
</ul>
</li>
</ul>
<p>Obviously this is a massive undertaking and would require massive overhaul of everything, but it did look like Google were able to pull it off in the end. (<a href="https://research.google.com/pubs/pub44860.html)">https://research.google.com/pubs/pub44860.html)</a>.</p>
<p>Tavis is banging on LastPass again…  <a href="https://www.ghacks.net/2017/03/21/full-last-pass-4-1-42-exploit-discovered/">https://www.ghacks.net/2017/03/21/full-last-pass-4-1-42-exploit-discovered/</a></p>
<p>Duo Security // Beyondcorp</p>
<p><a href="https://duo.com/blog/beyondcorp-for-the-rest-of-us">https://duo.com/blog/beyondcorp-for-the-rest-of-us</a></p>
<p>More info on Beyondcorp</p>
<p><a href="https://www.beyondcorp.com">https://www.beyondcorp.com</a></p>
<p>Misc// Hey google wrote a paper on U2F a while back</p>
<p><a href="http://fc16.ifca.ai/preproceedings/25_Lang.pdf">http://fc16.ifca.ai/preproceedings/25_Lang.pdf</a></p>
<p>Touched on briefly / “Secure Boot Stack and Machine Identity” at Google - Servers which need to boot up into a given state (Sounds like U/EFI except ‘ Google-designed security chip’)</p>
<p><a href="https://cloud.google.com/security/security-design/resources/google_infrastructure_whitepaper_fa.pdf">https://cloud.google.com/security/security-design/resources/google_infrastructure_whitepaper_fa.pdf</a></p>
<p>META // Patrick Gray (sic) interviewed Duo last week and talked about the same thing</p>
<p><a href="https://risky.biz/RB448/">https://risky.biz/RB448/</a></p>
<h4 id="source"><a href="http://brakeingsecurity.com/2017-013-multi-factor-auth-implementations-gotchas-and-solutions-with-matt">Source</a></h4>
<!-- raw HTML omitted -->

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2025-03-20-laser-harp-sets-the-tone/">Laser Harp Sets the Tone</a></li>
				
				<li><a href="/posts/2025-03-20-arduino-device-helps-split-the-g-on-a-p/">Arduino device helps split the G on a pint of Guinness</a></li>
				
				<li><a href="/posts/2025-03-20-the-70-best-early-amazon-spring-sale-ga/">The 70 best early Amazon Spring Sale gaming deals 2025</a></li>
				
				<li><a href="/posts/2025-03-20-tomorrow-and-tomorrow-and-tomorrow-info/">Tomorrow and tomorrow and tomorrow Information security and the Baseball Hall of Fame</a></li>
				
				<li><a href="/posts/2025-03-20-i-found-an-android-phone-that-can-convi/">I found an Android phone that can convince iPhone users to make the switch - and its not a flagship</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
